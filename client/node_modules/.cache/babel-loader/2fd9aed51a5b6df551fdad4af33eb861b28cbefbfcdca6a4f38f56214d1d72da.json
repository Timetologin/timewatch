{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\timewatch-clone\\\\client\\\\src\\\\pages\\\\Dashboard.js\",\n  _s = $RefreshSig$();\n// client/src/pages/Dashboard.js\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { api } from '../api';\nimport Toast from '../components/Toast';\nimport Modal from '../components/Modal';\nimport jsPDF from 'jspdf';\nimport 'jspdf-autotable';\nimport * as XLSX from 'xlsx';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction fmtMin(n) {\n  const h = Math.floor(n / 60);\n  const m = n % 60;\n  return `${h}ש ${m}ד`;\n}\nfunction todayISO() {\n  const d = new Date();\n  const off = d.getTimezoneOffset();\n  const z = new Date(d.getTime() - off * 60000);\n  return z.toISOString().slice(0, 10);\n}\nasync function getGeo() {\n  if (!('geolocation' in navigator)) return null;\n  return new Promise(resolve => {\n    navigator.geolocation.getCurrentPosition(pos => resolve({\n      lat: pos.coords.latitude,\n      lng: pos.coords.longitude\n    }), () => resolve(null), {\n      enableHighAccuracy: false,\n      timeout: 3000,\n      maximumAge: 60000\n    });\n  });\n}\nexport default function Dashboard() {\n  _s();\n  var _me$permissions2, _me$permissions3, _me$permissions4, _me$permissions5;\n  const [me, setMe] = useState(null);\n  const [today, setToday] = useState(null);\n  const [err, setErr] = useState('');\n  const [range, setRange] = useState({\n    from: todayISO(),\n    to: todayISO()\n  });\n  const [rows, setRows] = useState([]);\n\n  // פילטר עובד (לאדמין/מורשה)\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState('');\n\n  // modal עריכה\n  const [editOpen, setEditOpen] = useState(false);\n  const [editRowState, setEditRowState] = useState(null);\n  const [editForm, setEditForm] = useState({\n    clockIn: '',\n    clockOut: '',\n    notes: ''\n  });\n  const [busy, setBusy] = useState(false);\n  const [toast, setToast] = useState({\n    show: false,\n    type: 'success',\n    title: '',\n    message: ''\n  });\n  const showToast = (type, title, message = '') => setToast({\n    show: true,\n    type,\n    title,\n    message\n  });\n  const closeToast = () => setToast(t => ({\n    ...t,\n    show: false\n  }));\n  const [clock, setClock] = useState(new Date());\n  useEffect(() => {\n    const t = setInterval(() => setClock(new Date()), 1000);\n    return () => clearInterval(t);\n  }, []);\n  const timeText = useMemo(() => clock.toLocaleTimeString(), [clock]);\n  useEffect(() => {\n    (async (_m$user, _m$user$permissions) => {\n      const m = await api('/api/auth/me');\n      setMe(m.user);\n      if ((_m$user = m.user) !== null && _m$user !== void 0 && (_m$user$permissions = _m$user.permissions) !== null && _m$user$permissions !== void 0 && _m$user$permissions.attendanceReadAll) {\n        // טען רשימת עובדים לפילטר\n        try {\n          const list = await api('/api/admin/users-lite');\n          setUsers(list);\n        } catch {}\n      }\n      await refreshToday();\n      await loadReportBy(range.from, range.to, selectedUser);\n    })().catch(e => setErr(e.message));\n  }, []);\n  async function refreshToday() {\n    setErr('');\n    const d = todayISO();\n    const data = await api(`/api/attendance/report?from=${d}&to=${d}`);\n    setToday(data[0] || null);\n  }\n  async function doPost(path, okMsg, errMsg) {\n    if (busy) return;\n    setBusy(true);\n    setErr('');\n    try {\n      const geo = await getGeo();\n      await api(path, {\n        method: 'POST',\n        body: JSON.stringify(geo || {})\n      });\n      await refreshToday();\n      showToast('success', okMsg);\n    } catch (e) {\n      setErr(e.message);\n      showToast('error', errMsg || e.message);\n    } finally {\n      setBusy(false);\n    }\n  }\n  async function loadReport(e) {\n    var _e$preventDefault;\n    e === null || e === void 0 ? void 0 : (_e$preventDefault = e.preventDefault) === null || _e$preventDefault === void 0 ? void 0 : _e$preventDefault.call(e);\n    await loadReportBy(range.from, range.to, selectedUser);\n  }\n  async function loadReportBy(from, to, userId) {\n    setErr('');\n    try {\n      const params = new URLSearchParams({\n        from,\n        to\n      });\n      if (userId) params.set('userId', userId);\n      const data = await api(`/api/attendance/report?${params.toString()}`);\n      setRows(data);\n    } catch (e) {\n      setErr(e.message);\n    }\n  }\n  function logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    window.location.href = '/login';\n  }\n\n  // ===== Exporters =====\n  function exportCSV() {\n    const header = ['date', 'clockIn', 'clockOut', 'regularMinutes', 'overtimeMinutes', 'totalMinutes'];\n    const lines = [header.join(',')].concat(rows.map(r => {\n      var _r$regularMinutes, _r$overtimeMinutes, _r$totalMinutes;\n      return [r.date, r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '', r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '', (_r$regularMinutes = r.regularMinutes) !== null && _r$regularMinutes !== void 0 ? _r$regularMinutes : '', (_r$overtimeMinutes = r.overtimeMinutes) !== null && _r$overtimeMinutes !== void 0 ? _r$overtimeMinutes : '', (_r$totalMinutes = r.totalMinutes) !== null && _r$totalMinutes !== void 0 ? _r$totalMinutes : ''].join(',');\n    }));\n    const blob = new Blob([lines.join('\\n')], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `attendance_${range.from}_${range.to}.csv`;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    URL.revokeObjectURL(url);\n    showToast('success', 'CSV נוצר בהצלחה');\n  }\n  function exportXLSX() {\n    const data = rows.map(r => ({\n      Date: r.date,\n      ClockIn: r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '',\n      ClockOut: r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '',\n      Regular: r.regularMinutes ? fmtMin(r.regularMinutes) : '',\n      Overtime: r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '',\n      Total: r.totalMinutes ? fmtMin(r.totalMinutes) : ''\n    }));\n    const ws = XLSX.utils.json_to_sheet(data);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, 'Report');\n    XLSX.writeFile(wb, `attendance_${range.from}_${range.to}.xlsx`);\n    showToast('success', 'Excel נוצר בהצלחה');\n  }\n  function exportPDF() {\n    const doc = new jsPDF({\n      orientation: 'p',\n      unit: 'pt',\n      format: 'a4'\n    });\n    doc.setFontSize(14);\n    doc.text(`Attendance Report ${range.from} - ${range.to}`, 40, 40);\n    const table = rows.map(r => [r.date, r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '-', r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '-', r.regularMinutes ? fmtMin(r.regularMinutes) : '-', r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '-', r.totalMinutes ? fmtMin(r.totalMinutes) : '-']);\n    doc.autoTable({\n      head: [['Date', 'Clock In', 'Clock Out', 'Regular', 'Overtime', 'Total']],\n      body: table,\n      startY: 60\n    });\n    const y = doc.lastAutoTable.finalY + 30;\n    doc.setFontSize(12);\n    doc.text('Approved by:', 40, y);\n    doc.line(120, y + 2, 300, y + 2);\n    doc.text('(Signature)', 120, y + 18);\n    doc.text(`Generated: ${new Date().toLocaleString()}`, 40, y + 40);\n    doc.save(`attendance_${range.from}_${range.to}.pdf`);\n    showToast('success', 'PDF נשמר');\n  }\n\n  // ===== Edit modal =====\n  function openEdit(r) {\n    var _me$permissions;\n    if (!(me !== null && me !== void 0 && (_me$permissions = me.permissions) !== null && _me$permissions !== void 0 && _me$permissions.attendanceEdit)) return;\n    setEditRowState(r);\n    setEditForm({\n      clockIn: r.clockIn ? new Date(r.clockIn).toISOString().slice(0, 16) : '',\n      clockOut: r.clockOut ? new Date(r.clockOut).toISOString().slice(0, 16) : '',\n      notes: r.notes || ''\n    });\n    setEditOpen(true);\n  }\n  async function saveEdit() {\n    try {\n      const body = {};\n      if (editForm.clockIn) body.clockIn = new Date(editForm.clockIn).toISOString();\n      if (editForm.clockOut) body.clockOut = new Date(editForm.clockOut).toISOString();\n      body.notes = editForm.notes || '';\n      await api(`/api/attendance/${editRowState._id}`, {\n        method: 'PUT',\n        body: JSON.stringify(body)\n      });\n      setEditOpen(false);\n      await loadReportBy(range.from, range.to, selectedUser);\n      await refreshToday();\n      showToast('success', 'עודכן בהצלחה');\n    } catch (e) {\n      showToast('error', e.message);\n    }\n  }\n  const inShift = !!(today !== null && today !== void 0 && today.clockIn) && !(today !== null && today !== void 0 && today.clockOut);\n  const hasOpenBreak = !!((today === null || today === void 0 ? void 0 : today.breaks) || []).find(b => b.start && !b.end);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen p-4\",\n    children: [/*#__PURE__*/_jsxDEV(Toast, {\n      show: toast.show,\n      type: toast.type,\n      title: toast.title,\n      message: toast.message,\n      onClose: closeToast\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: editOpen,\n      title: \"\\u05E2\\u05E8\\u05D9\\u05DB\\u05EA \\u05E8\\u05E9\\u05D5\\u05DE\\u05D4\",\n      onClose: () => setEditOpen(false),\n      actions: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"px-4 py-2 rounded-xl border bg-white\",\n          onClick: () => setEditOpen(false),\n          children: \"\\u05D1\\u05D9\\u05D8\\u05D5\\u05DC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"px-4 py-2 rounded-xl bg-black text-white\",\n          onClick: saveEdit,\n          children: \"\\u05E9\\u05DE\\u05D9\\u05E8\\u05D4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-1\",\n          children: \"Clock In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"datetime-local\",\n          className: \"border rounded-xl px-3 py-2 w-full\",\n          value: editForm.clockIn,\n          onChange: e => setEditForm(f => ({\n            ...f,\n            clockIn: e.target.value\n          }))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-1\",\n          children: \"Clock Out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"datetime-local\",\n          className: \"border rounded-xl px-3 py-2 w-full\",\n          value: editForm.clockOut,\n          onChange: e => setEditForm(f => ({\n            ...f,\n            clockOut: e.target.value\n          }))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-1\",\n          children: \"\\u05D4\\u05E2\\u05E8\\u05D5\\u05EA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"border rounded-xl px-3 py-2 w-full\",\n          rows: 3,\n          value: editForm.notes,\n          onChange: e => setEditForm(f => ({\n            ...f,\n            notes: e.target.value\n          }))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"flex items-center justify-between mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/logo.png\",\n          alt: \"Costoro\",\n          className: \"w-10 h-10 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-semibold text-lg\",\n            children: [\"\\u05E9\\u05DC\\u05D5\\u05DD \", (me === null || me === void 0 ? void 0 : me.name) || '']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-slate-500\",\n            children: me === null || me === void 0 ? void 0 : me.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [(me === null || me === void 0 ? void 0 : (_me$permissions2 = me.permissions) === null || _me$permissions2 === void 0 ? void 0 : _me$permissions2.manageUsers) && /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/admin/users\",\n          className: \"px-3 py-2 rounded-xl bg-white border shadow text-sm\",\n          children: \"\\u05E0\\u05D9\\u05D4\\u05D5\\u05DC \\u05DE\\u05E9\\u05EA\\u05DE\\u05E9\\u05D9\\u05DD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `px-3 py-1 rounded-xl text-white text-sm ${hasOpenBreak ? 'bg-amber-500' : inShift ? 'bg-emerald-600' : 'bg-slate-400'}`,\n          children: hasOpenBreak ? 'בהפסקה' : inShift ? 'במשמרת' : 'לא במשמרת'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-3 py-1 rounded-xl bg-white shadow text-sm\",\n          children: timeText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: logout,\n          className: \"px-4 py-2 rounded-xl border bg-white hover:bg-slate-50\",\n          children: \"\\u05D4\\u05EA\\u05E0\\u05EA\\u05E7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }, this), err && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 text-rose-600\",\n      children: err\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 15\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"grid md:grid-cols-2 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold\",\n            children: \"\\u05D3\\u05D5\\u05D7 \\u05DC\\u05E4\\u05D9 \\u05EA\\u05D0\\u05E8\\u05D9\\u05DB\\u05D9\\u05DD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 13\n          }, this), (me === null || me === void 0 ? void 0 : (_me$permissions3 = me.permissions) === null || _me$permissions3 === void 0 ? void 0 : _me$permissions3.exportReports) && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex gap-3 text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportCSV,\n              className: \"underline\",\n              children: \"CSV\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportXLSX,\n              className: \"underline\",\n              children: \"Excel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportPDF,\n              className: \"underline\",\n              children: \"PDF\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: loadReport,\n          className: \"flex flex-wrap items-end gap-3 mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm mb-1\",\n              children: \"\\u05DE\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              className: \"border rounded-xl px-3 py-2\",\n              value: range.from,\n              onChange: e => setRange(v => ({\n                ...v,\n                from: e.target.value\n              })),\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm mb-1\",\n              children: \"\\u05E2\\u05D3 \\u05EA\\u05D0\\u05E8\\u05D9\\u05DA\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              className: \"border rounded-xl px-3 py-2\",\n              value: range.to,\n              onChange: e => setRange(v => ({\n                ...v,\n                to: e.target.value\n              })),\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this), (me === null || me === void 0 ? void 0 : (_me$permissions4 = me.permissions) === null || _me$permissions4 === void 0 ? void 0 : _me$permissions4.attendanceReadAll) && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm mb-1\",\n              children: \"\\u05E2\\u05D5\\u05D1\\u05D3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"border rounded-xl px-3 py-2 min-w-[220px]\",\n              value: selectedUser,\n              onChange: e => setSelectedUser(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u2014 \\u05DB\\u05DC\\u05D5\\u05DC/\\u05D4 \\u05D0\\u05EA \\u05E2\\u05E6\\u05DE\\u05D9 \\u2014\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 221,\n                columnNumber: 19\n              }, this), users.map(u => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: u._id,\n                children: [u.name, \" \\xB7 \", u.department || 'ללא מחלקה']\n              }, u._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            type: \"submit\",\n            disabled: busy,\n            children: \"\\u05D8\\u05E2\\u05DF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-auto\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"min-w-full text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"text-left border-b\",\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 238,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"Clock In\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"Clock Out\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05E8\\u05D2\\u05D9\\u05DC\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05E0\\u05D5\\u05E1\\u05E4\\u05D5\\u05EA\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 242,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05E1\\u05D4\\u05F4\\u05DB\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 19\n                }, this), (me === null || me === void 0 ? void 0 : (_me$permissions5 = me.permissions) === null || _me$permissions5 === void 0 ? void 0 : _me$permissions5.attendanceEdit) && /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 55\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: [rows.map(r => {\n                var _me$permissions6;\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"border-b\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.date\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 251,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 252,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.regularMinutes ? fmtMin(r.regularMinutes) : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 253,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 254,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.totalMinutes ? fmtMin(r.totalMinutes) : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 255,\n                    columnNumber: 21\n                  }, this), (me === null || me === void 0 ? void 0 : (_me$permissions6 = me.permissions) === null || _me$permissions6 === void 0 ? void 0 : _me$permissions6.attendanceEdit) && /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"px-3 py-1 rounded-xl border\",\n                      onClick: () => openEdit(r),\n                      children: \"\\u05E2\\u05E8\\u05D5\\u05DA\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 258,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 257,\n                    columnNumber: 23\n                  }, this)]\n                }, r._id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 19\n                }, this);\n              }), !rows.length && /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"py-4 text-slate-400\",\n                  colSpan: 7,\n                  children: \"\\u05D0\\u05D9\\u05DF \\u05E0\\u05EA\\u05D5\\u05E0\\u05D9\\u05DD \\u05DC\\u05EA\\u05E7\\u05D5\\u05E4\\u05D4 \\u05D6\\u05D5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 263,\n                  columnNumber: 38\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 34\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold\",\n            children: \"\\u05D4\\u05D9\\u05D5\\u05DD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-slate-500\",\n            children: inShift ? 'במשמרת פעילה' : 'לא במשמרת'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 flex-wrap mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || inShift,\n            onClick: () => doPost('/api/attendance/clockin', 'Clock In בוצע!'),\n            children: \"Clock In\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || !inShift,\n            onClick: () => doPost('/api/attendance/clockout', 'Clock Out בוצע!'),\n            children: \"Clock Out\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || !inShift || hasOpenBreak,\n            onClick: () => doPost('/api/attendance/break/start', 'הפסקה התחילה'),\n            children: \"Start Break\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || !inShift || !hasOpenBreak,\n            onClick: () => doPost('/api/attendance/break/end', 'הפסקה הסתיימה'),\n            children: \"End Break\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Clock In:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.clockIn ? new Date(today.clockIn).toLocaleTimeString() : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Clock Out:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 285,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.clockOut ? new Date(today.clockOut).toLocaleTimeString() : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05E1\\u05D4\\u05F4\\u05DB:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.totalMinutes ? fmtMin(today.totalMinutes) : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05E8\\u05D2\\u05D9\\u05DC:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.regularMinutes ? fmtMin(today.regularMinutes) : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05E0\\u05D5\\u05E1\\u05E4\\u05D5\\u05EA:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.overtimeMinutes ? fmtMin(today.overtimeMinutes) : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05D4\\u05E4\\u05E1\\u05E7\\u05D5\\u05EA:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"list-disc pr-5\",\n              children: ((today === null || today === void 0 ? void 0 : today.breaks) || []).map((b, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [b.start ? new Date(b.start).toLocaleTimeString() : '-', \" \\u2192 \", b.end ? new Date(b.end).toLocaleTimeString() : '—']\n              }, i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 293,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `.btn{background:black;color:white;border-radius:0.75rem;padding:0.6rem 1rem}.btn[disabled]{opacity:.4;cursor:not-allowed}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 137,\n    columnNumber: 5\n  }, this);\n}\n_s(Dashboard, \"DqMSGwSgLb47TknwMoNS7Ld7V2k=\");\n_c = Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","useMemo","api","Toast","Modal","jsPDF","XLSX","jsxDEV","_jsxDEV","Fragment","_Fragment","fmtMin","n","h","Math","floor","m","todayISO","d","Date","off","getTimezoneOffset","z","getTime","toISOString","slice","getGeo","navigator","Promise","resolve","geolocation","getCurrentPosition","pos","lat","coords","latitude","lng","longitude","enableHighAccuracy","timeout","maximumAge","Dashboard","_s","_me$permissions2","_me$permissions3","_me$permissions4","_me$permissions5","me","setMe","today","setToday","err","setErr","range","setRange","from","to","rows","setRows","users","setUsers","selectedUser","setSelectedUser","editOpen","setEditOpen","editRowState","setEditRowState","editForm","setEditForm","clockIn","clockOut","notes","busy","setBusy","toast","setToast","show","type","title","message","showToast","closeToast","t","clock","setClock","setInterval","clearInterval","timeText","toLocaleTimeString","_m$user","_m$user$permissions","user","permissions","attendanceReadAll","list","refreshToday","loadReportBy","catch","e","data","doPost","path","okMsg","errMsg","geo","method","body","JSON","stringify","loadReport","_e$preventDefault","preventDefault","call","userId","params","URLSearchParams","set","toString","logout","localStorage","removeItem","window","location","href","exportCSV","header","lines","join","concat","map","r","_r$regularMinutes","_r$overtimeMinutes","_r$totalMinutes","date","regularMinutes","overtimeMinutes","totalMinutes","blob","Blob","url","URL","createObjectURL","a","document","createElement","download","appendChild","click","remove","revokeObjectURL","exportXLSX","ClockIn","ClockOut","Regular","Overtime","Total","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","writeFile","exportPDF","doc","orientation","unit","format","setFontSize","text","table","autoTable","head","startY","y","lastAutoTable","finalY","line","toLocaleString","save","openEdit","_me$permissions","attendanceEdit","saveEdit","_id","inShift","hasOpenBreak","breaks","find","b","start","end","className","children","onClose","fileName","_jsxFileName","lineNumber","columnNumber","open","actions","onClick","value","onChange","f","target","src","alt","name","email","manageUsers","exportReports","onSubmit","v","required","u","department","disabled","_me$permissions6","length","colSpan","i","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/timewatch-clone/client/src/pages/Dashboard.js"],"sourcesContent":["// client/src/pages/Dashboard.js\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { api } from '../api';\nimport Toast from '../components/Toast';\nimport Modal from '../components/Modal';\nimport jsPDF from 'jspdf';\nimport 'jspdf-autotable';\nimport * as XLSX from 'xlsx';\n\nfunction fmtMin(n){ const h=Math.floor(n/60); const m=n%60; return `${h}ש ${m}ד`; }\nfunction todayISO(){ const d=new Date(); const off=d.getTimezoneOffset(); const z=new Date(d.getTime()-off*60000); return z.toISOString().slice(0,10); }\nasync function getGeo(){ if(!('geolocation' in navigator)) return null;\n  return new Promise(resolve=>{ navigator.geolocation.getCurrentPosition(\n    pos=>resolve({lat:pos.coords.latitude,lng:pos.coords.longitude}),\n    ()=>resolve(null), { enableHighAccuracy:false, timeout:3000, maximumAge:60000 }\n  );});\n}\n\nexport default function Dashboard(){\n  const [me,setMe]=useState(null);\n  const [today,setToday]=useState(null);\n  const [err,setErr]=useState('');\n  const [range,setRange]=useState({ from: todayISO(), to: todayISO() });\n  const [rows,setRows]=useState([]);\n\n  // פילטר עובד (לאדמין/מורשה)\n  const [users,setUsers]=useState([]);\n  const [selectedUser,setSelectedUser]=useState('');\n\n  // modal עריכה\n  const [editOpen,setEditOpen]=useState(false);\n  const [editRowState,setEditRowState]=useState(null);\n  const [editForm,setEditForm]=useState({ clockIn:'', clockOut:'', notes:'' });\n\n  const [busy,setBusy]=useState(false);\n  const [toast,setToast]=useState({ show:false, type:'success', title:'', message:'' });\n  const showToast=(type,title,message='')=>setToast({ show:true, type, title, message });\n  const closeToast=()=>setToast(t=>({ ...t, show:false }));\n\n  const [clock,setClock]=useState(new Date());\n  useEffect(()=>{ const t=setInterval(()=>setClock(new Date()),1000); return ()=>clearInterval(t); },[]);\n  const timeText=useMemo(()=>clock.toLocaleTimeString(),[clock]);\n\n  useEffect(()=>{ (async()=>{\n      const m=await api('/api/auth/me'); setMe(m.user);\n      if (m.user?.permissions?.attendanceReadAll) {\n        // טען רשימת עובדים לפילטר\n        try { const list = await api('/api/admin/users-lite'); setUsers(list); } catch {}\n      }\n      await refreshToday();\n      await loadReportBy(range.from, range.to, selectedUser);\n  })().catch(e=>setErr(e.message)); },[]);\n\n  async function refreshToday(){\n    setErr('');\n    const d=todayISO();\n    const data=await api(`/api/attendance/report?from=${d}&to=${d}`);\n    setToday(data[0]||null);\n  }\n\n  async function doPost(path, okMsg, errMsg){\n    if (busy) return; setBusy(true); setErr('');\n    try{\n      const geo = await getGeo();\n      await api(path, { method:'POST', body: JSON.stringify(geo || {}) });\n      await refreshToday();\n      showToast('success', okMsg);\n    }catch(e){ setErr(e.message); showToast('error', errMsg || e.message); }\n    finally{ setBusy(false); }\n  }\n\n  async function loadReport(e){ e?.preventDefault?.(); await loadReportBy(range.from, range.to, selectedUser); }\n\n  async function loadReportBy(from,to,userId){\n    setErr('');\n    try{\n      const params = new URLSearchParams({ from, to });\n      if (userId) params.set('userId', userId);\n      const data=await api(`/api/attendance/report?${params.toString()}`);\n      setRows(data);\n    }catch(e){ setErr(e.message); }\n  }\n\n  function logout(){ localStorage.removeItem('token'); localStorage.removeItem('user'); window.location.href='/login'; }\n\n  // ===== Exporters =====\n  function exportCSV(){\n    const header=['date','clockIn','clockOut','regularMinutes','overtimeMinutes','totalMinutes'];\n    const lines=[header.join(',')].concat(\n      rows.map(r=>[r.date, r.clockIn?new Date(r.clockIn).toLocaleTimeString():'', r.clockOut?new Date(r.clockOut).toLocaleTimeString():'', r.regularMinutes??'', r.overtimeMinutes??'', r.totalMinutes??''].join(','))\n    );\n    const blob=new Blob([lines.join('\\n')],{type:'text/csv;charset=utf-8;'}); const url=URL.createObjectURL(blob);\n    const a=document.createElement('a'); a.href=url; a.download=`attendance_${range.from}_${range.to}.csv`; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);\n    showToast('success','CSV נוצר בהצלחה');\n  }\n  function exportXLSX(){\n    const data=rows.map(r=>({Date:r.date, ClockIn:r.clockIn?new Date(r.clockIn).toLocaleTimeString():'', ClockOut:r.clockOut?new Date(r.clockOut).toLocaleTimeString():'', Regular:r.regularMinutes?fmtMin(r.regularMinutes):'', Overtime:r.overtimeMinutes?fmtMin(r.overtimeMinutes):'', Total:r.totalMinutes?fmtMin(r.totalMinutes):''}));\n    const ws=XLSX.utils.json_to_sheet(data); const wb=XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb,ws,'Report'); XLSX.writeFile(wb,`attendance_${range.from}_${range.to}.xlsx`); showToast('success','Excel נוצר בהצלחה');\n  }\n  function exportPDF(){\n    const doc=new jsPDF({orientation:'p',unit:'pt',format:'a4'}); doc.setFontSize(14); doc.text(`Attendance Report ${range.from} - ${range.to}`,40,40);\n    const table=rows.map(r=>[r.date, r.clockIn?new Date(r.clockIn).toLocaleTimeString():'-', r.clockOut?new Date(r.clockOut).toLocaleTimeString():'-', r.regularMinutes?fmtMin(r.regularMinutes):'-', r.overtimeMinutes?fmtMin(r.overtimeMinutes):'-', r.totalMinutes?fmtMin(r.totalMinutes):'-']);\n    doc.autoTable({ head:[['Date','Clock In','Clock Out','Regular','Overtime','Total']], body:table, startY:60 });\n    const y=doc.lastAutoTable.finalY+30; doc.setFontSize(12); doc.text('Approved by:',40,y); doc.line(120,y+2,300,y+2); doc.text('(Signature)',120,y+18); doc.text(`Generated: ${new Date().toLocaleString()}`,40,y+40);\n    doc.save(`attendance_${range.from}_${range.to}.pdf`); showToast('success','PDF נשמר');\n  }\n\n  // ===== Edit modal =====\n  function openEdit(r){\n    if (!me?.permissions?.attendanceEdit) return;\n    setEditRowState(r);\n    setEditForm({\n      clockIn: r.clockIn ? new Date(r.clockIn).toISOString().slice(0,16) : '',\n      clockOut: r.clockOut ? new Date(r.clockOut).toISOString().slice(0,16) : '',\n      notes: r.notes || ''\n    });\n    setEditOpen(true);\n  }\n  async function saveEdit(){\n    try{\n      const body={};\n      if (editForm.clockIn) body.clockIn = new Date(editForm.clockIn).toISOString();\n      if (editForm.clockOut) body.clockOut = new Date(editForm.clockOut).toISOString();\n      body.notes = editForm.notes || '';\n      await api(`/api/attendance/${editRowState._id}`, { method:'PUT', body: JSON.stringify(body) });\n      setEditOpen(false);\n      await loadReportBy(range.from, range.to, selectedUser);\n      await refreshToday();\n      showToast('success','עודכן בהצלחה');\n    }catch(e){ showToast('error', e.message); }\n  }\n\n  const inShift=!!today?.clockIn && !today?.clockOut;\n  const hasOpenBreak=!!(today?.breaks||[]).find(b=>b.start && !b.end);\n\n  return (\n    <div className=\"min-h-screen p-4\">\n      <Toast show={toast.show} type={toast.type} title={toast.title} message={toast.message} onClose={closeToast} />\n\n      {/* Modal עריכה */}\n      <Modal\n        open={editOpen}\n        title=\"עריכת רשומה\"\n        onClose={()=>setEditOpen(false)}\n        actions={\n          <>\n            <button className=\"px-4 py-2 rounded-xl border bg-white\" onClick={()=>setEditOpen(false)}>ביטול</button>\n            <button className=\"px-4 py-2 rounded-xl bg-black text-white\" onClick={saveEdit}>שמירה</button>\n          </>\n        }\n      >\n        <div>\n          <label className=\"block text-sm mb-1\">Clock In</label>\n          <input type=\"datetime-local\" className=\"border rounded-xl px-3 py-2 w-full\"\n                 value={editForm.clockIn} onChange={e=>setEditForm(f=>({...f,clockIn:e.target.value}))}/>\n        </div>\n        <div>\n          <label className=\"block text-sm mb-1\">Clock Out</label>\n          <input type=\"datetime-local\" className=\"border rounded-xl px-3 py-2 w-full\"\n                 value={editForm.clockOut} onChange={e=>setEditForm(f=>({...f,clockOut:e.target.value}))}/>\n        </div>\n        <div>\n          <label className=\"block text-sm mb-1\">הערות</label>\n          <textarea className=\"border rounded-xl px-3 py-2 w-full\" rows={3}\n                    value={editForm.notes} onChange={e=>setEditForm(f=>({...f,notes:e.target.value}))}/>\n        </div>\n      </Modal>\n\n      <header className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-3\">\n          <img src=\"/logo.png\" alt=\"Costoro\" className=\"w-10 h-10 rounded-md\" />\n          <div>\n            <div className=\"font-semibold text-lg\">שלום {me?.name || ''}</div>\n            <div className=\"text-sm text-slate-500\">{me?.email}</div>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          {me?.permissions?.manageUsers && (\n            <a href=\"/admin/users\" className=\"px-3 py-2 rounded-xl bg-white border shadow text-sm\">ניהול משתמשים</a>\n          )}\n          <div className={`px-3 py-1 rounded-xl text-white text-sm ${hasOpenBreak ? 'bg-amber-500' : inShift ? 'bg-emerald-600' : 'bg-slate-400'}`}>\n            {hasOpenBreak ? 'בהפסקה' : inShift ? 'במשמרת' : 'לא במשמרת'}\n          </div>\n          <div className=\"px-3 py-1 rounded-xl bg-white shadow text-sm\">{timeText}</div>\n          <button onClick={logout} className=\"px-4 py-2 rounded-xl border bg-white hover:bg-slate-50\">התנתק</button>\n        </div>\n      </header>\n\n      {err && <div className=\"mb-4 text-rose-600\">{err}</div>}\n\n      <main className=\"grid md:grid-cols-2 gap-6\">\n        {/* דוחות */}\n        <div className=\"bg-white rounded-2xl shadow p-5\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h2 className=\"text-xl font-semibold\">דוח לפי תאריכים</h2>\n            {me?.permissions?.exportReports && (\n              <div className=\"flex gap-3 text-sm\">\n                <button onClick={exportCSV} className=\"underline\">CSV</button>\n                <button onClick={exportXLSX} className=\"underline\">Excel</button>\n                <button onClick={exportPDF} className=\"underline\">PDF</button>\n              </div>\n            )}\n          </div>\n\n          <form onSubmit={loadReport} className=\"flex flex-wrap items-end gap-3 mb-4\">\n            <div>\n              <label className=\"block text-sm mb-1\">מתאריך</label>\n              <input type=\"date\" className=\"border rounded-xl px-3 py-2\" value={range.from} onChange={(e)=>setRange(v=>({...v, from:e.target.value}))} required />\n            </div>\n            <div>\n              <label className=\"block text-sm mb-1\">עד תאריך</label>\n              <input type=\"date\" className=\"border rounded-xl px-3 py-2\" value={range.to} onChange={(e)=>setRange(v=>({...v, to:e.target.value}))} required />\n            </div>\n\n            {me?.permissions?.attendanceReadAll && (\n              <div>\n                <label className=\"block text-sm mb-1\">עובד</label>\n                <select className=\"border rounded-xl px-3 py-2 min-w-[220px]\"\n                        value={selectedUser} onChange={(e)=>setSelectedUser(e.target.value)}>\n                  <option value=\"\">— כלול/ה את עצמי —</option>\n                  {users.map(u=>(\n                    <option key={u._id} value={u._id}>\n                      {u.name} · {u.department || 'ללא מחלקה'}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n\n            <button className=\"btn\" type=\"submit\" disabled={busy}>טען</button>\n          </form>\n\n          <div className=\"overflow-auto\">\n            <table className=\"min-w-full text-sm\">\n              <thead>\n                <tr className=\"text-left border-b\">\n                  <th className=\"py-2\">תאריך</th>\n                  <th className=\"py-2\">Clock In</th>\n                  <th className=\"py-2\">Clock Out</th>\n                  <th className=\"py-2\">רגיל</th>\n                  <th className=\"py-2\">נוספות</th>\n                  <th className=\"py-2\">סה״כ</th>\n                  {me?.permissions?.attendanceEdit && <th className=\"py-2\"></th>}\n                </tr>\n              </thead>\n              <tbody>\n                {rows.map(r=>(\n                  <tr key={r._id} className=\"border-b\">\n                    <td className=\"py-2\">{r.date}</td>\n                    <td className=\"py-2\">{r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '-'}</td>\n                    <td className=\"py-2\">{r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '-'}</td>\n                    <td className=\"py-2\">{r.regularMinutes ? fmtMin(r.regularMinutes) : '-'}</td>\n                    <td className=\"py-2\">{r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '-'}</td>\n                    <td className=\"py-2\">{r.totalMinutes ? fmtMin(r.totalMinutes) : '-'}</td>\n                    {me?.permissions?.attendanceEdit && (\n                      <td className=\"py-2\">\n                        <button className=\"px-3 py-1 rounded-xl border\" onClick={()=>openEdit(r)}>ערוך</button>\n                      </td>\n                    )}\n                  </tr>\n                ))}\n                {!rows.length && <tr><td className=\"py-4 text-slate-400\" colSpan={7}>אין נתונים לתקופה זו</td></tr>}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/* היום */}\n        <div className=\"bg-white rounded-2xl shadow p-5\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h2 className=\"text-xl font-semibold\">היום</h2>\n            <div className=\"text-xs text-slate-500\">{inShift ? 'במשמרת פעילה' : 'לא במשמרת'}</div>\n          </div>\n\n          <div className=\"flex gap-2 flex-wrap mb-4\">\n            <button className=\"btn\" disabled={busy || inShift} onClick={()=>doPost('/api/attendance/clockin','Clock In בוצע!')}>Clock In</button>\n            <button className=\"btn\" disabled={busy || !inShift} onClick={()=>doPost('/api/attendance/clockout','Clock Out בוצע!')}>Clock Out</button>\n            <button className=\"btn\" disabled={busy || !inShift || hasOpenBreak} onClick={()=>doPost('/api/attendance/break/start','הפסקה התחילה')}>Start Break</button>\n            <button className=\"btn\" disabled={busy || !inShift || !hasOpenBreak} onClick={()=>doPost('/api/attendance/break/end','הפסקה הסתיימה')}>End Break</button>\n          </div>\n\n          <div className=\"space-y-2\">\n            <div><b>Clock In:</b> {today?.clockIn ? new Date(today.clockIn).toLocaleTimeString() : '-'}</div>\n            <div><b>Clock Out:</b> {today?.clockOut ? new Date(today.clockOut).toLocaleTimeString() : '-'}</div>\n            <div><b>סה״כ:</b> {today?.totalMinutes ? fmtMin(today.totalMinutes) : '-'}</div>\n            <div><b>רגיל:</b> {today?.regularMinutes ? fmtMin(today.regularMinutes) : '-'}</div>\n            <div><b>נוספות:</b> {today?.overtimeMinutes ? fmtMin(today.overtimeMinutes) : '-'}</div>\n            <div>\n              <b>הפסקות:</b>\n              <ul className=\"list-disc pr-5\">\n                {(today?.breaks || []).map((b,i)=>(\n                  <li key={i}>{b.start?new Date(b.start).toLocaleTimeString():'-'} → {b.end?new Date(b.end).toLocaleTimeString():'—'}</li>\n                ))}\n              </ul>\n            </div>\n          </div>\n        </div>\n      </main>\n\n      <style>{`.btn{background:black;color:white;border-radius:0.75rem;padding:0.6rem 1rem}.btn[disabled]{opacity:.4;cursor:not-allowed}`}</style>\n    </div>\n  );\n}\n"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,OAAO;AAC3D,SAASC,GAAG,QAAQ,QAAQ;AAC5B,OAAOC,KAAK,MAAM,qBAAqB;AACvC,OAAOC,KAAK,MAAM,qBAAqB;AACvC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAO,iBAAiB;AACxB,OAAO,KAAKC,IAAI,MAAM,MAAM;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE7B,SAASC,MAAMA,CAACC,CAAC,EAAC;EAAE,MAAMC,CAAC,GAACC,IAAI,CAACC,KAAK,CAACH,CAAC,GAAC,EAAE,CAAC;EAAE,MAAMI,CAAC,GAACJ,CAAC,GAAC,EAAE;EAAE,OAAO,GAAGC,CAAC,KAAKG,CAAC,GAAG;AAAE;AAClF,SAASC,QAAQA,CAAA,EAAE;EAAE,MAAMC,CAAC,GAAC,IAAIC,IAAI,CAAC,CAAC;EAAE,MAAMC,GAAG,GAACF,CAAC,CAACG,iBAAiB,CAAC,CAAC;EAAE,MAAMC,CAAC,GAAC,IAAIH,IAAI,CAACD,CAAC,CAACK,OAAO,CAAC,CAAC,GAACH,GAAG,GAAC,KAAK,CAAC;EAAE,OAAOE,CAAC,CAACE,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC;AAAE;AACvJ,eAAeC,MAAMA,CAAA,EAAE;EAAE,IAAG,EAAE,aAAa,IAAIC,SAAS,CAAC,EAAE,OAAO,IAAI;EACpE,OAAO,IAAIC,OAAO,CAACC,OAAO,IAAE;IAAEF,SAAS,CAACG,WAAW,CAACC,kBAAkB,CACpEC,GAAG,IAAEH,OAAO,CAAC;MAACI,GAAG,EAACD,GAAG,CAACE,MAAM,CAACC,QAAQ;MAACC,GAAG,EAACJ,GAAG,CAACE,MAAM,CAACG;IAAS,CAAC,CAAC,EAChE,MAAIR,OAAO,CAAC,IAAI,CAAC,EAAE;MAAES,kBAAkB,EAAC,KAAK;MAAEC,OAAO,EAAC,IAAI;MAAEC,UAAU,EAAC;IAAM,CAChF,CAAC;EAAC,CAAC,CAAC;AACN;AAEA,eAAe,SAASC,SAASA,CAAA,EAAE;EAAAC,EAAA;EAAA,IAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA;EACjC,MAAM,CAACC,EAAE,EAACC,KAAK,CAAC,GAAChD,QAAQ,CAAC,IAAI,CAAC;EAC/B,MAAM,CAACiD,KAAK,EAACC,QAAQ,CAAC,GAAClD,QAAQ,CAAC,IAAI,CAAC;EACrC,MAAM,CAACmD,GAAG,EAACC,MAAM,CAAC,GAACpD,QAAQ,CAAC,EAAE,CAAC;EAC/B,MAAM,CAACqD,KAAK,EAACC,QAAQ,CAAC,GAACtD,QAAQ,CAAC;IAAEuD,IAAI,EAAEtC,QAAQ,CAAC,CAAC;IAAEuC,EAAE,EAAEvC,QAAQ,CAAC;EAAE,CAAC,CAAC;EACrE,MAAM,CAACwC,IAAI,EAACC,OAAO,CAAC,GAAC1D,QAAQ,CAAC,EAAE,CAAC;;EAEjC;EACA,MAAM,CAAC2D,KAAK,EAACC,QAAQ,CAAC,GAAC5D,QAAQ,CAAC,EAAE,CAAC;EACnC,MAAM,CAAC6D,YAAY,EAACC,eAAe,CAAC,GAAC9D,QAAQ,CAAC,EAAE,CAAC;;EAEjD;EACA,MAAM,CAAC+D,QAAQ,EAACC,WAAW,CAAC,GAAChE,QAAQ,CAAC,KAAK,CAAC;EAC5C,MAAM,CAACiE,YAAY,EAACC,eAAe,CAAC,GAAClE,QAAQ,CAAC,IAAI,CAAC;EACnD,MAAM,CAACmE,QAAQ,EAACC,WAAW,CAAC,GAACpE,QAAQ,CAAC;IAAEqE,OAAO,EAAC,EAAE;IAAEC,QAAQ,EAAC,EAAE;IAAEC,KAAK,EAAC;EAAG,CAAC,CAAC;EAE5E,MAAM,CAACC,IAAI,EAACC,OAAO,CAAC,GAACzE,QAAQ,CAAC,KAAK,CAAC;EACpC,MAAM,CAAC0E,KAAK,EAACC,QAAQ,CAAC,GAAC3E,QAAQ,CAAC;IAAE4E,IAAI,EAAC,KAAK;IAAEC,IAAI,EAAC,SAAS;IAAEC,KAAK,EAAC,EAAE;IAAEC,OAAO,EAAC;EAAG,CAAC,CAAC;EACrF,MAAMC,SAAS,GAACA,CAACH,IAAI,EAACC,KAAK,EAACC,OAAO,GAAC,EAAE,KAAGJ,QAAQ,CAAC;IAAEC,IAAI,EAAC,IAAI;IAAEC,IAAI;IAAEC,KAAK;IAAEC;EAAQ,CAAC,CAAC;EACtF,MAAME,UAAU,GAACA,CAAA,KAAIN,QAAQ,CAACO,CAAC,KAAG;IAAE,GAAGA,CAAC;IAAEN,IAAI,EAAC;EAAM,CAAC,CAAC,CAAC;EAExD,MAAM,CAACO,KAAK,EAACC,QAAQ,CAAC,GAACpF,QAAQ,CAAC,IAAImB,IAAI,CAAC,CAAC,CAAC;EAC3CpB,SAAS,CAAC,MAAI;IAAE,MAAMmF,CAAC,GAACG,WAAW,CAAC,MAAID,QAAQ,CAAC,IAAIjE,IAAI,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC;IAAE,OAAO,MAAImE,aAAa,CAACJ,CAAC,CAAC;EAAE,CAAC,EAAC,EAAE,CAAC;EACtG,MAAMK,QAAQ,GAACtF,OAAO,CAAC,MAAIkF,KAAK,CAACK,kBAAkB,CAAC,CAAC,EAAC,CAACL,KAAK,CAAC,CAAC;EAE9DpF,SAAS,CAAC,MAAI;IAAE,CAAC,OAAA0F,OAAA,EAAAC,mBAAA,KAAS;MACtB,MAAM1E,CAAC,GAAC,MAAMd,GAAG,CAAC,cAAc,CAAC;MAAE8C,KAAK,CAAChC,CAAC,CAAC2E,IAAI,CAAC;MAChD,KAAAF,OAAA,GAAIzE,CAAC,CAAC2E,IAAI,cAAAF,OAAA,gBAAAC,mBAAA,GAAND,OAAA,CAAQG,WAAW,cAAAF,mBAAA,eAAnBA,mBAAA,CAAqBG,iBAAiB,EAAE;QAC1C;QACA,IAAI;UAAE,MAAMC,IAAI,GAAG,MAAM5F,GAAG,CAAC,uBAAuB,CAAC;UAAE0D,QAAQ,CAACkC,IAAI,CAAC;QAAE,CAAC,CAAC,MAAM,CAAC;MAClF;MACA,MAAMC,YAAY,CAAC,CAAC;MACpB,MAAMC,YAAY,CAAC3C,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,EAAE,EAAEK,YAAY,CAAC;IAC1D,CAAC,EAAE,CAAC,CAACoC,KAAK,CAACC,CAAC,IAAE9C,MAAM,CAAC8C,CAAC,CAACnB,OAAO,CAAC,CAAC;EAAE,CAAC,EAAC,EAAE,CAAC;EAEvC,eAAegB,YAAYA,CAAA,EAAE;IAC3B3C,MAAM,CAAC,EAAE,CAAC;IACV,MAAMlC,CAAC,GAACD,QAAQ,CAAC,CAAC;IAClB,MAAMkF,IAAI,GAAC,MAAMjG,GAAG,CAAC,+BAA+BgB,CAAC,OAAOA,CAAC,EAAE,CAAC;IAChEgC,QAAQ,CAACiD,IAAI,CAAC,CAAC,CAAC,IAAE,IAAI,CAAC;EACzB;EAEA,eAAeC,MAAMA,CAACC,IAAI,EAAEC,KAAK,EAAEC,MAAM,EAAC;IACxC,IAAI/B,IAAI,EAAE;IAAQC,OAAO,CAAC,IAAI,CAAC;IAAErB,MAAM,CAAC,EAAE,CAAC;IAC3C,IAAG;MACD,MAAMoD,GAAG,GAAG,MAAM9E,MAAM,CAAC,CAAC;MAC1B,MAAMxB,GAAG,CAACmG,IAAI,EAAE;QAAEI,MAAM,EAAC,MAAM;QAAEC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,GAAG,IAAI,CAAC,CAAC;MAAE,CAAC,CAAC;MACnE,MAAMT,YAAY,CAAC,CAAC;MACpBf,SAAS,CAAC,SAAS,EAAEsB,KAAK,CAAC;IAC7B,CAAC,QAAMJ,CAAC,EAAC;MAAE9C,MAAM,CAAC8C,CAAC,CAACnB,OAAO,CAAC;MAAEC,SAAS,CAAC,OAAO,EAAEuB,MAAM,IAAIL,CAAC,CAACnB,OAAO,CAAC;IAAE,CAAC,SACjE;MAAEN,OAAO,CAAC,KAAK,CAAC;IAAE;EAC3B;EAEA,eAAeoC,UAAUA,CAACX,CAAC,EAAC;IAAA,IAAAY,iBAAA;IAAEZ,CAAC,aAADA,CAAC,wBAAAY,iBAAA,GAADZ,CAAC,CAAEa,cAAc,cAAAD,iBAAA,uBAAjBA,iBAAA,CAAAE,IAAA,CAAAd,CAAoB,CAAC;IAAE,MAAMF,YAAY,CAAC3C,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,EAAE,EAAEK,YAAY,CAAC;EAAE;EAE7G,eAAemC,YAAYA,CAACzC,IAAI,EAACC,EAAE,EAACyD,MAAM,EAAC;IACzC7D,MAAM,CAAC,EAAE,CAAC;IACV,IAAG;MACD,MAAM8D,MAAM,GAAG,IAAIC,eAAe,CAAC;QAAE5D,IAAI;QAAEC;MAAG,CAAC,CAAC;MAChD,IAAIyD,MAAM,EAAEC,MAAM,CAACE,GAAG,CAAC,QAAQ,EAAEH,MAAM,CAAC;MACxC,MAAMd,IAAI,GAAC,MAAMjG,GAAG,CAAC,0BAA0BgH,MAAM,CAACG,QAAQ,CAAC,CAAC,EAAE,CAAC;MACnE3D,OAAO,CAACyC,IAAI,CAAC;IACf,CAAC,QAAMD,CAAC,EAAC;MAAE9C,MAAM,CAAC8C,CAAC,CAACnB,OAAO,CAAC;IAAE;EAChC;EAEA,SAASuC,MAAMA,CAAA,EAAE;IAAEC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;IAAED,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC;IAAEC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAC,QAAQ;EAAE;;EAErH;EACA,SAASC,SAASA,CAAA,EAAE;IAClB,MAAMC,MAAM,GAAC,CAAC,MAAM,EAAC,SAAS,EAAC,UAAU,EAAC,gBAAgB,EAAC,iBAAiB,EAAC,cAAc,CAAC;IAC5F,MAAMC,KAAK,GAAC,CAACD,MAAM,CAACE,IAAI,CAAC,GAAG,CAAC,CAAC,CAACC,MAAM,CACnCvE,IAAI,CAACwE,GAAG,CAACC,CAAC;MAAA,IAAAC,iBAAA,EAAAC,kBAAA,EAAAC,eAAA;MAAA,OAAE,CAACH,CAAC,CAACI,IAAI,EAAEJ,CAAC,CAAC7D,OAAO,GAAC,IAAIlD,IAAI,CAAC+G,CAAC,CAAC7D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAC,EAAE,EAAE0C,CAAC,CAAC5D,QAAQ,GAAC,IAAInD,IAAI,CAAC+G,CAAC,CAAC5D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAC,EAAE,GAAA2C,iBAAA,GAAED,CAAC,CAACK,cAAc,cAAAJ,iBAAA,cAAAA,iBAAA,GAAE,EAAE,GAAAC,kBAAA,GAAEF,CAAC,CAACM,eAAe,cAAAJ,kBAAA,cAAAA,kBAAA,GAAE,EAAE,GAAAC,eAAA,GAAEH,CAAC,CAACO,YAAY,cAAAJ,eAAA,cAAAA,eAAA,GAAE,EAAE,CAAC,CAACN,IAAI,CAAC,GAAG,CAAC;IAAA,EACjN,CAAC;IACD,MAAMW,IAAI,GAAC,IAAIC,IAAI,CAAC,CAACb,KAAK,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,EAAC;MAAClD,IAAI,EAAC;IAAyB,CAAC,CAAC;IAAE,MAAM+D,GAAG,GAACC,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC;IAC7G,MAAMK,CAAC,GAACC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IAAEF,CAAC,CAACpB,IAAI,GAACiB,GAAG;IAAEG,CAAC,CAACG,QAAQ,GAAC,cAAc7F,KAAK,CAACE,IAAI,IAAIF,KAAK,CAACG,EAAE,MAAM;IAAEwF,QAAQ,CAACtC,IAAI,CAACyC,WAAW,CAACJ,CAAC,CAAC;IAAEA,CAAC,CAACK,KAAK,CAAC,CAAC;IAAEL,CAAC,CAACM,MAAM,CAAC,CAAC;IAAER,GAAG,CAACS,eAAe,CAACV,GAAG,CAAC;IACrL5D,SAAS,CAAC,SAAS,EAAC,iBAAiB,CAAC;EACxC;EACA,SAASuE,UAAUA,CAAA,EAAE;IACnB,MAAMpD,IAAI,GAAC1C,IAAI,CAACwE,GAAG,CAACC,CAAC,KAAG;MAAC/G,IAAI,EAAC+G,CAAC,CAACI,IAAI;MAAEkB,OAAO,EAACtB,CAAC,CAAC7D,OAAO,GAAC,IAAIlD,IAAI,CAAC+G,CAAC,CAAC7D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAC,EAAE;MAAEiE,QAAQ,EAACvB,CAAC,CAAC5D,QAAQ,GAAC,IAAInD,IAAI,CAAC+G,CAAC,CAAC5D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAC,EAAE;MAAEkE,OAAO,EAACxB,CAAC,CAACK,cAAc,GAAC5H,MAAM,CAACuH,CAAC,CAACK,cAAc,CAAC,GAAC,EAAE;MAAEoB,QAAQ,EAACzB,CAAC,CAACM,eAAe,GAAC7H,MAAM,CAACuH,CAAC,CAACM,eAAe,CAAC,GAAC,EAAE;MAAEoB,KAAK,EAAC1B,CAAC,CAACO,YAAY,GAAC9H,MAAM,CAACuH,CAAC,CAACO,YAAY,CAAC,GAAC;IAAE,CAAC,CAAC,CAAC;IACvU,MAAMoB,EAAE,GAACvJ,IAAI,CAACwJ,KAAK,CAACC,aAAa,CAAC5D,IAAI,CAAC;IAAE,MAAM6D,EAAE,GAAC1J,IAAI,CAACwJ,KAAK,CAACG,QAAQ,CAAC,CAAC;IAAE3J,IAAI,CAACwJ,KAAK,CAACI,iBAAiB,CAACF,EAAE,EAACH,EAAE,EAAC,QAAQ,CAAC;IAAEvJ,IAAI,CAAC6J,SAAS,CAACH,EAAE,EAAC,cAAc3G,KAAK,CAACE,IAAI,IAAIF,KAAK,CAACG,EAAE,OAAO,CAAC;IAAEwB,SAAS,CAAC,SAAS,EAAC,mBAAmB,CAAC;EACjO;EACA,SAASoF,SAASA,CAAA,EAAE;IAClB,MAAMC,GAAG,GAAC,IAAIhK,KAAK,CAAC;MAACiK,WAAW,EAAC,GAAG;MAACC,IAAI,EAAC,IAAI;MAACC,MAAM,EAAC;IAAI,CAAC,CAAC;IAAEH,GAAG,CAACI,WAAW,CAAC,EAAE,CAAC;IAAEJ,GAAG,CAACK,IAAI,CAAC,qBAAqBrH,KAAK,CAACE,IAAI,MAAMF,KAAK,CAACG,EAAE,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC;IAClJ,MAAMmH,KAAK,GAAClH,IAAI,CAACwE,GAAG,CAACC,CAAC,IAAE,CAACA,CAAC,CAACI,IAAI,EAAEJ,CAAC,CAAC7D,OAAO,GAAC,IAAIlD,IAAI,CAAC+G,CAAC,CAAC7D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAC,GAAG,EAAE0C,CAAC,CAAC5D,QAAQ,GAAC,IAAInD,IAAI,CAAC+G,CAAC,CAAC5D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAC,GAAG,EAAE0C,CAAC,CAACK,cAAc,GAAC5H,MAAM,CAACuH,CAAC,CAACK,cAAc,CAAC,GAAC,GAAG,EAAEL,CAAC,CAACM,eAAe,GAAC7H,MAAM,CAACuH,CAAC,CAACM,eAAe,CAAC,GAAC,GAAG,EAAEN,CAAC,CAACO,YAAY,GAAC9H,MAAM,CAACuH,CAAC,CAACO,YAAY,CAAC,GAAC,GAAG,CAAC,CAAC;IAC9R4B,GAAG,CAACO,SAAS,CAAC;MAAEC,IAAI,EAAC,CAAC,CAAC,MAAM,EAAC,UAAU,EAAC,WAAW,EAAC,SAAS,EAAC,UAAU,EAAC,OAAO,CAAC,CAAC;MAAEnE,IAAI,EAACiE,KAAK;MAAEG,MAAM,EAAC;IAAG,CAAC,CAAC;IAC7G,MAAMC,CAAC,GAACV,GAAG,CAACW,aAAa,CAACC,MAAM,GAAC,EAAE;IAAEZ,GAAG,CAACI,WAAW,CAAC,EAAE,CAAC;IAAEJ,GAAG,CAACK,IAAI,CAAC,cAAc,EAAC,EAAE,EAACK,CAAC,CAAC;IAAEV,GAAG,CAACa,IAAI,CAAC,GAAG,EAACH,CAAC,GAAC,CAAC,EAAC,GAAG,EAACA,CAAC,GAAC,CAAC,CAAC;IAAEV,GAAG,CAACK,IAAI,CAAC,aAAa,EAAC,GAAG,EAACK,CAAC,GAAC,EAAE,CAAC;IAAEV,GAAG,CAACK,IAAI,CAAC,cAAc,IAAIvJ,IAAI,CAAC,CAAC,CAACgK,cAAc,CAAC,CAAC,EAAE,EAAC,EAAE,EAACJ,CAAC,GAAC,EAAE,CAAC;IACnNV,GAAG,CAACe,IAAI,CAAC,cAAc/H,KAAK,CAACE,IAAI,IAAIF,KAAK,CAACG,EAAE,MAAM,CAAC;IAAEwB,SAAS,CAAC,SAAS,EAAC,UAAU,CAAC;EACvF;;EAEA;EACA,SAASqG,QAAQA,CAACnD,CAAC,EAAC;IAAA,IAAAoD,eAAA;IAClB,IAAI,EAACvI,EAAE,aAAFA,EAAE,gBAAAuI,eAAA,GAAFvI,EAAE,CAAE6C,WAAW,cAAA0F,eAAA,eAAfA,eAAA,CAAiBC,cAAc,GAAE;IACtCrH,eAAe,CAACgE,CAAC,CAAC;IAClB9D,WAAW,CAAC;MACVC,OAAO,EAAE6D,CAAC,CAAC7D,OAAO,GAAG,IAAIlD,IAAI,CAAC+G,CAAC,CAAC7D,OAAO,CAAC,CAAC7C,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC,GAAG,EAAE;MACvE6C,QAAQ,EAAE4D,CAAC,CAAC5D,QAAQ,GAAG,IAAInD,IAAI,CAAC+G,CAAC,CAAC5D,QAAQ,CAAC,CAAC9C,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC,GAAG,EAAE;MAC1E8C,KAAK,EAAE2D,CAAC,CAAC3D,KAAK,IAAI;IACpB,CAAC,CAAC;IACFP,WAAW,CAAC,IAAI,CAAC;EACnB;EACA,eAAewH,QAAQA,CAAA,EAAE;IACvB,IAAG;MACD,MAAM9E,IAAI,GAAC,CAAC,CAAC;MACb,IAAIvC,QAAQ,CAACE,OAAO,EAAEqC,IAAI,CAACrC,OAAO,GAAG,IAAIlD,IAAI,CAACgD,QAAQ,CAACE,OAAO,CAAC,CAAC7C,WAAW,CAAC,CAAC;MAC7E,IAAI2C,QAAQ,CAACG,QAAQ,EAAEoC,IAAI,CAACpC,QAAQ,GAAG,IAAInD,IAAI,CAACgD,QAAQ,CAACG,QAAQ,CAAC,CAAC9C,WAAW,CAAC,CAAC;MAChFkF,IAAI,CAACnC,KAAK,GAAGJ,QAAQ,CAACI,KAAK,IAAI,EAAE;MACjC,MAAMrE,GAAG,CAAC,mBAAmB+D,YAAY,CAACwH,GAAG,EAAE,EAAE;QAAEhF,MAAM,EAAC,KAAK;QAAEC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACF,IAAI;MAAE,CAAC,CAAC;MAC9F1C,WAAW,CAAC,KAAK,CAAC;MAClB,MAAMgC,YAAY,CAAC3C,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,EAAE,EAAEK,YAAY,CAAC;MACtD,MAAMkC,YAAY,CAAC,CAAC;MACpBf,SAAS,CAAC,SAAS,EAAC,cAAc,CAAC;IACrC,CAAC,QAAMkB,CAAC,EAAC;MAAElB,SAAS,CAAC,OAAO,EAAEkB,CAAC,CAACnB,OAAO,CAAC;IAAE;EAC5C;EAEA,MAAM2G,OAAO,GAAC,CAAC,EAACzI,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEoB,OAAO,KAAI,EAACpB,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEqB,QAAQ;EAClD,MAAMqH,YAAY,GAAC,CAAC,CAAC,CAAC,CAAA1I,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAE2I,MAAM,KAAE,EAAE,EAAEC,IAAI,CAACC,CAAC,IAAEA,CAAC,CAACC,KAAK,IAAI,CAACD,CAAC,CAACE,GAAG,CAAC;EAEnE,oBACExL,OAAA;IAAKyL,SAAS,EAAC,kBAAkB;IAAAC,QAAA,gBAC/B1L,OAAA,CAACL,KAAK;MAACyE,IAAI,EAAEF,KAAK,CAACE,IAAK;MAACC,IAAI,EAAEH,KAAK,CAACG,IAAK;MAACC,KAAK,EAAEJ,KAAK,CAACI,KAAM;MAACC,OAAO,EAAEL,KAAK,CAACK,OAAQ;MAACoH,OAAO,EAAElH;IAAW;MAAAmH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAG9G/L,OAAA,CAACJ,KAAK;MACJoM,IAAI,EAAEzI,QAAS;MACfe,KAAK,EAAC,+DAAa;MACnBqH,OAAO,EAAEA,CAAA,KAAInI,WAAW,CAAC,KAAK,CAAE;MAChCyI,OAAO,eACLjM,OAAA,CAAAE,SAAA;QAAAwL,QAAA,gBACE1L,OAAA;UAAQyL,SAAS,EAAC,sCAAsC;UAACS,OAAO,EAAEA,CAAA,KAAI1I,WAAW,CAAC,KAAK,CAAE;UAAAkI,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACxG/L,OAAA;UAAQyL,SAAS,EAAC,0CAA0C;UAACS,OAAO,EAAElB,QAAS;UAAAU,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA,eAC9F,CACH;MAAAL,QAAA,gBAED1L,OAAA;QAAA0L,QAAA,gBACE1L,OAAA;UAAOyL,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAQ;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACtD/L,OAAA;UAAOqE,IAAI,EAAC,gBAAgB;UAACoH,SAAS,EAAC,oCAAoC;UACpEU,KAAK,EAAExI,QAAQ,CAACE,OAAQ;UAACuI,QAAQ,EAAE1G,CAAC,IAAE9B,WAAW,CAACyI,CAAC,KAAG;YAAC,GAAGA,CAAC;YAACxI,OAAO,EAAC6B,CAAC,CAAC4G,MAAM,CAACH;UAAK,CAAC,CAAC;QAAE;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5F,CAAC,eACN/L,OAAA;QAAA0L,QAAA,gBACE1L,OAAA;UAAOyL,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAS;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACvD/L,OAAA;UAAOqE,IAAI,EAAC,gBAAgB;UAACoH,SAAS,EAAC,oCAAoC;UACpEU,KAAK,EAAExI,QAAQ,CAACG,QAAS;UAACsI,QAAQ,EAAE1G,CAAC,IAAE9B,WAAW,CAACyI,CAAC,KAAG;YAAC,GAAGA,CAAC;YAACvI,QAAQ,EAAC4B,CAAC,CAAC4G,MAAM,CAACH;UAAK,CAAC,CAAC;QAAE;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9F,CAAC,eACN/L,OAAA;QAAA0L,QAAA,gBACE1L,OAAA;UAAOyL,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACnD/L,OAAA;UAAUyL,SAAS,EAAC,oCAAoC;UAACxI,IAAI,EAAE,CAAE;UACvDkJ,KAAK,EAAExI,QAAQ,CAACI,KAAM;UAACqI,QAAQ,EAAE1G,CAAC,IAAE9B,WAAW,CAACyI,CAAC,KAAG;YAAC,GAAGA,CAAC;YAACtI,KAAK,EAAC2B,CAAC,CAAC4G,MAAM,CAACH;UAAK,CAAC,CAAC;QAAE;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3F,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CAAC,eAER/L,OAAA;MAAQyL,SAAS,EAAC,wCAAwC;MAAAC,QAAA,gBACxD1L,OAAA;QAAKyL,SAAS,EAAC,yBAAyB;QAAAC,QAAA,gBACtC1L,OAAA;UAAKuM,GAAG,EAAC,WAAW;UAACC,GAAG,EAAC,SAAS;UAACf,SAAS,EAAC;QAAsB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACtE/L,OAAA;UAAA0L,QAAA,gBACE1L,OAAA;YAAKyL,SAAS,EAAC,uBAAuB;YAAAC,QAAA,GAAC,2BAAK,EAAC,CAAAnJ,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEkK,IAAI,KAAI,EAAE;UAAA;YAAAb,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAClE/L,OAAA;YAAKyL,SAAS,EAAC,wBAAwB;YAAAC,QAAA,EAAEnJ,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEmK;UAAK;YAAAd,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAEN/L,OAAA;QAAKyL,SAAS,EAAC,yBAAyB;QAAAC,QAAA,GACrC,CAAAnJ,EAAE,aAAFA,EAAE,wBAAAJ,gBAAA,GAAFI,EAAE,CAAE6C,WAAW,cAAAjD,gBAAA,uBAAfA,gBAAA,CAAiBwK,WAAW,kBAC3B3M,OAAA;UAAGmH,IAAI,EAAC,cAAc;UAACsE,SAAS,EAAC,qDAAqD;UAAAC,QAAA,EAAC;QAAa;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CACxG,eACD/L,OAAA;UAAKyL,SAAS,EAAE,2CAA2CN,YAAY,GAAG,cAAc,GAAGD,OAAO,GAAG,gBAAgB,GAAG,cAAc,EAAG;UAAAQ,QAAA,EACtIP,YAAY,GAAG,QAAQ,GAAGD,OAAO,GAAG,QAAQ,GAAG;QAAW;UAAAU,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxD,CAAC,eACN/L,OAAA;UAAKyL,SAAS,EAAC,8CAA8C;UAAAC,QAAA,EAAE3G;QAAQ;UAAA6G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAC9E/L,OAAA;UAAQkM,OAAO,EAAEpF,MAAO;UAAC2E,SAAS,EAAC,wDAAwD;UAAAC,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC,EAERpJ,GAAG,iBAAI3C,OAAA;MAAKyL,SAAS,EAAC,oBAAoB;MAAAC,QAAA,EAAE/I;IAAG;MAAAiJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,eAEvD/L,OAAA;MAAMyL,SAAS,EAAC,2BAA2B;MAAAC,QAAA,gBAEzC1L,OAAA;QAAKyL,SAAS,EAAC,iCAAiC;QAAAC,QAAA,gBAC9C1L,OAAA;UAAKyL,SAAS,EAAC,wCAAwC;UAAAC,QAAA,gBACrD1L,OAAA;YAAIyL,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAe;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EACzD,CAAAxJ,EAAE,aAAFA,EAAE,wBAAAH,gBAAA,GAAFG,EAAE,CAAE6C,WAAW,cAAAhD,gBAAA,uBAAfA,gBAAA,CAAiBwK,aAAa,kBAC7B5M,OAAA;YAAKyL,SAAS,EAAC,oBAAoB;YAAAC,QAAA,gBACjC1L,OAAA;cAAQkM,OAAO,EAAE9E,SAAU;cAACqE,SAAS,EAAC,WAAW;cAAAC,QAAA,EAAC;YAAG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eAC9D/L,OAAA;cAAQkM,OAAO,EAAEnD,UAAW;cAAC0C,SAAS,EAAC,WAAW;cAAAC,QAAA,EAAC;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACjE/L,OAAA;cAAQkM,OAAO,EAAEtC,SAAU;cAAC6B,SAAS,EAAC,WAAW;cAAAC,QAAA,EAAC;YAAG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3D,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC,eAEN/L,OAAA;UAAM6M,QAAQ,EAAExG,UAAW;UAACoF,SAAS,EAAC,qCAAqC;UAAAC,QAAA,gBACzE1L,OAAA;YAAA0L,QAAA,gBACE1L,OAAA;cAAOyL,SAAS,EAAC,oBAAoB;cAAAC,QAAA,EAAC;YAAM;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACpD/L,OAAA;cAAOqE,IAAI,EAAC,MAAM;cAACoH,SAAS,EAAC,6BAA6B;cAACU,KAAK,EAAEtJ,KAAK,CAACE,IAAK;cAACqJ,QAAQ,EAAG1G,CAAC,IAAG5C,QAAQ,CAACgK,CAAC,KAAG;gBAAC,GAAGA,CAAC;gBAAE/J,IAAI,EAAC2C,CAAC,CAAC4G,MAAM,CAACH;cAAK,CAAC,CAAC,CAAE;cAACY,QAAQ;YAAA;cAAAnB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACjJ,CAAC,eACN/L,OAAA;YAAA0L,QAAA,gBACE1L,OAAA;cAAOyL,SAAS,EAAC,oBAAoB;cAAAC,QAAA,EAAC;YAAQ;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACtD/L,OAAA;cAAOqE,IAAI,EAAC,MAAM;cAACoH,SAAS,EAAC,6BAA6B;cAACU,KAAK,EAAEtJ,KAAK,CAACG,EAAG;cAACoJ,QAAQ,EAAG1G,CAAC,IAAG5C,QAAQ,CAACgK,CAAC,KAAG;gBAAC,GAAGA,CAAC;gBAAE9J,EAAE,EAAC0C,CAAC,CAAC4G,MAAM,CAACH;cAAK,CAAC,CAAC,CAAE;cAACY,QAAQ;YAAA;cAAAnB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7I,CAAC,EAEL,CAAAxJ,EAAE,aAAFA,EAAE,wBAAAF,gBAAA,GAAFE,EAAE,CAAE6C,WAAW,cAAA/C,gBAAA,uBAAfA,gBAAA,CAAiBgD,iBAAiB,kBACjCrF,OAAA;YAAA0L,QAAA,gBACE1L,OAAA;cAAOyL,SAAS,EAAC,oBAAoB;cAAAC,QAAA,EAAC;YAAI;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAClD/L,OAAA;cAAQyL,SAAS,EAAC,2CAA2C;cACrDU,KAAK,EAAE9I,YAAa;cAAC+I,QAAQ,EAAG1G,CAAC,IAAGpC,eAAe,CAACoC,CAAC,CAAC4G,MAAM,CAACH,KAAK,CAAE;cAAAT,QAAA,gBAC1E1L,OAAA;gBAAQmM,KAAK,EAAC,EAAE;gBAAAT,QAAA,EAAC;cAAkB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,EAC3C5I,KAAK,CAACsE,GAAG,CAACuF,CAAC,iBACVhN,OAAA;gBAAoBmM,KAAK,EAAEa,CAAC,CAAC/B,GAAI;gBAAAS,QAAA,GAC9BsB,CAAC,CAACP,IAAI,EAAC,QAAG,EAACO,CAAC,CAACC,UAAU,IAAI,WAAW;cAAA,GAD5BD,CAAC,CAAC/B,GAAG;gBAAAW,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAEV,CACT,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CACN,eAED/L,OAAA;YAAQyL,SAAS,EAAC,KAAK;YAACpH,IAAI,EAAC,QAAQ;YAAC6I,QAAQ,EAAElJ,IAAK;YAAA0H,QAAA,EAAC;UAAG;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9D,CAAC,eAEP/L,OAAA;UAAKyL,SAAS,EAAC,eAAe;UAAAC,QAAA,eAC5B1L,OAAA;YAAOyL,SAAS,EAAC,oBAAoB;YAAAC,QAAA,gBACnC1L,OAAA;cAAA0L,QAAA,eACE1L,OAAA;gBAAIyL,SAAS,EAAC,oBAAoB;gBAAAC,QAAA,gBAChC1L,OAAA;kBAAIyL,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAK;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC/B/L,OAAA;kBAAIyL,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAQ;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAClC/L,OAAA;kBAAIyL,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAS;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACnC/L,OAAA;kBAAIyL,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAI;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC9B/L,OAAA;kBAAIyL,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAM;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAChC/L,OAAA;kBAAIyL,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAI;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,EAC7B,CAAAxJ,EAAE,aAAFA,EAAE,wBAAAD,gBAAA,GAAFC,EAAE,CAAE6C,WAAW,cAAA9C,gBAAA,uBAAfA,gBAAA,CAAiByI,cAAc,kBAAI/K,OAAA;kBAAIyL,SAAS,EAAC;gBAAM;kBAAAG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC5D;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACR/L,OAAA;cAAA0L,QAAA,GACGzI,IAAI,CAACwE,GAAG,CAACC,CAAC;gBAAA,IAAAyF,gBAAA;gBAAA,oBACTnN,OAAA;kBAAgByL,SAAS,EAAC,UAAU;kBAAAC,QAAA,gBAClC1L,OAAA;oBAAIyL,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEhE,CAAC,CAACI;kBAAI;oBAAA8D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAClC/L,OAAA;oBAAIyL,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEhE,CAAC,CAAC7D,OAAO,GAAG,IAAIlD,IAAI,CAAC+G,CAAC,CAAC7D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAG;kBAAG;oBAAA4G,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eACtF/L,OAAA;oBAAIyL,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEhE,CAAC,CAAC5D,QAAQ,GAAG,IAAInD,IAAI,CAAC+G,CAAC,CAAC5D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAG;kBAAG;oBAAA4G,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eACxF/L,OAAA;oBAAIyL,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEhE,CAAC,CAACK,cAAc,GAAG5H,MAAM,CAACuH,CAAC,CAACK,cAAc,CAAC,GAAG;kBAAG;oBAAA6D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAC7E/L,OAAA;oBAAIyL,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEhE,CAAC,CAACM,eAAe,GAAG7H,MAAM,CAACuH,CAAC,CAACM,eAAe,CAAC,GAAG;kBAAG;oBAAA4D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAC/E/L,OAAA;oBAAIyL,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEhE,CAAC,CAACO,YAAY,GAAG9H,MAAM,CAACuH,CAAC,CAACO,YAAY,CAAC,GAAG;kBAAG;oBAAA2D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,EACxE,CAAAxJ,EAAE,aAAFA,EAAE,wBAAA4K,gBAAA,GAAF5K,EAAE,CAAE6C,WAAW,cAAA+H,gBAAA,uBAAfA,gBAAA,CAAiBpC,cAAc,kBAC9B/K,OAAA;oBAAIyL,SAAS,EAAC,MAAM;oBAAAC,QAAA,eAClB1L,OAAA;sBAAQyL,SAAS,EAAC,6BAA6B;sBAACS,OAAO,EAAEA,CAAA,KAAIrB,QAAQ,CAACnD,CAAC,CAAE;sBAAAgE,QAAA,EAAC;oBAAI;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACrF,CACL;gBAAA,GAXMrE,CAAC,CAACuD,GAAG;kBAAAW,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAYV,CAAC;cAAA,CACN,CAAC,EACD,CAAC9I,IAAI,CAACmK,MAAM,iBAAIpN,OAAA;gBAAA0L,QAAA,eAAI1L,OAAA;kBAAIyL,SAAS,EAAC,qBAAqB;kBAAC4B,OAAO,EAAE,CAAE;kBAAA3B,QAAA,EAAC;gBAAoB;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC9F,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGN/L,OAAA;QAAKyL,SAAS,EAAC,iCAAiC;QAAAC,QAAA,gBAC9C1L,OAAA;UAAKyL,SAAS,EAAC,wCAAwC;UAAAC,QAAA,gBACrD1L,OAAA;YAAIyL,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAI;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC/C/L,OAAA;YAAKyL,SAAS,EAAC,wBAAwB;YAAAC,QAAA,EAAER,OAAO,GAAG,cAAc,GAAG;UAAW;YAAAU,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnF,CAAC,eAEN/L,OAAA;UAAKyL,SAAS,EAAC,2BAA2B;UAAAC,QAAA,gBACxC1L,OAAA;YAAQyL,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAElJ,IAAI,IAAIkH,OAAQ;YAACgB,OAAO,EAAEA,CAAA,KAAItG,MAAM,CAAC,yBAAyB,EAAC,gBAAgB,CAAE;YAAA8F,QAAA,EAAC;UAAQ;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACrI/L,OAAA;YAAQyL,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAElJ,IAAI,IAAI,CAACkH,OAAQ;YAACgB,OAAO,EAAEA,CAAA,KAAItG,MAAM,CAAC,0BAA0B,EAAC,iBAAiB,CAAE;YAAA8F,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACzI/L,OAAA;YAAQyL,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAElJ,IAAI,IAAI,CAACkH,OAAO,IAAIC,YAAa;YAACe,OAAO,EAAEA,CAAA,KAAItG,MAAM,CAAC,6BAA6B,EAAC,cAAc,CAAE;YAAA8F,QAAA,EAAC;UAAW;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAC3J/L,OAAA;YAAQyL,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAElJ,IAAI,IAAI,CAACkH,OAAO,IAAI,CAACC,YAAa;YAACe,OAAO,EAAEA,CAAA,KAAItG,MAAM,CAAC,2BAA2B,EAAC,eAAe,CAAE;YAAA8F,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtJ,CAAC,eAEN/L,OAAA;UAAKyL,SAAS,EAAC,WAAW;UAAAC,QAAA,gBACxB1L,OAAA;YAAA0L,QAAA,gBAAK1L,OAAA;cAAA0L,QAAA,EAAG;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACtJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEoB,OAAO,GAAG,IAAIlD,IAAI,CAAC8B,KAAK,CAACoB,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAG,GAAG;UAAA;YAAA4G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACjG/L,OAAA;YAAA0L,QAAA,gBAAK1L,OAAA;cAAA0L,QAAA,EAAG;YAAU;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACtJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEqB,QAAQ,GAAG,IAAInD,IAAI,CAAC8B,KAAK,CAACqB,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAG,GAAG;UAAA;YAAA4G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACpG/L,OAAA;YAAA0L,QAAA,gBAAK1L,OAAA;cAAA0L,QAAA,EAAG;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACtJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEwF,YAAY,GAAG9H,MAAM,CAACsC,KAAK,CAACwF,YAAY,CAAC,GAAG,GAAG;UAAA;YAAA2D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAChF/L,OAAA;YAAA0L,QAAA,gBAAK1L,OAAA;cAAA0L,QAAA,EAAG;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACtJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEsF,cAAc,GAAG5H,MAAM,CAACsC,KAAK,CAACsF,cAAc,CAAC,GAAG,GAAG;UAAA;YAAA6D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACpF/L,OAAA;YAAA0L,QAAA,gBAAK1L,OAAA;cAAA0L,QAAA,EAAG;YAAO;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACtJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEuF,eAAe,GAAG7H,MAAM,CAACsC,KAAK,CAACuF,eAAe,CAAC,GAAG,GAAG;UAAA;YAAA4D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACxF/L,OAAA;YAAA0L,QAAA,gBACE1L,OAAA;cAAA0L,QAAA,EAAG;YAAO;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eACd/L,OAAA;cAAIyL,SAAS,EAAC,gBAAgB;cAAAC,QAAA,EAC3B,CAAC,CAAAjJ,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAE2I,MAAM,KAAI,EAAE,EAAE3D,GAAG,CAAC,CAAC6D,CAAC,EAACgC,CAAC,kBAC7BtN,OAAA;gBAAA0L,QAAA,GAAaJ,CAAC,CAACC,KAAK,GAAC,IAAI5K,IAAI,CAAC2K,CAAC,CAACC,KAAK,CAAC,CAACvG,kBAAkB,CAAC,CAAC,GAAC,GAAG,EAAC,UAAG,EAACsG,CAAC,CAACE,GAAG,GAAC,IAAI7K,IAAI,CAAC2K,CAAC,CAACE,GAAG,CAAC,CAACxG,kBAAkB,CAAC,CAAC,GAAC,GAAG;cAAA,GAAzGsI,CAAC;gBAAA1B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAA6G,CACxH;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,eAEP/L,OAAA;MAAA0L,QAAA,EAAQ;IAA2H;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACzI,CAAC;AAEV;AAAC7J,EAAA,CA7RuBD,SAAS;AAAAsL,EAAA,GAATtL,SAAS;AAAA,IAAAsL,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}