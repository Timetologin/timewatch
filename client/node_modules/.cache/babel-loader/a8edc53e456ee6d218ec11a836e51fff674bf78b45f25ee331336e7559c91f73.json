{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\timewatch-clone\\\\client\\\\src\\\\pages\\\\Dashboard.js\",\n  _s = $RefreshSig$();\n// client/src/pages/Dashboard.js\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { api } from '../api';\nimport Toast from '../components/Toast';\nimport Modal from '../components/Modal';\nimport jsPDF from 'jspdf';\nimport 'jspdf-autotable';\nimport * as XLSX from 'xlsx';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction fmtMin(n) {\n  const h = Math.floor(n / 60);\n  const m = n % 60;\n  return `${h}ש ${m}ד`;\n}\nfunction todayISO() {\n  const d = new Date();\n  const off = d.getTimezoneOffset();\n  const z = new Date(d.getTime() - off * 60000);\n  return z.toISOString().slice(0, 10);\n}\nasync function getGeo() {\n  if (!('geolocation' in navigator)) return null;\n  return new Promise(resolve => {\n    navigator.geolocation.getCurrentPosition(pos => resolve({\n      lat: pos.coords.latitude,\n      lng: pos.coords.longitude\n    }), () => resolve(null), {\n      enableHighAccuracy: false,\n      timeout: 3000,\n      maximumAge: 60000\n    });\n  });\n}\nexport default function Dashboard() {\n  _s();\n  var _me$permissions2, _me$permissions$expor, _me$permissions3, _me$permissions4, _me$permissions5;\n  const [me, setMe] = useState(null);\n  const [today, setToday] = useState(null);\n  const [err, setErr] = useState('');\n  const [range, setRange] = useState({\n    from: todayISO(),\n    to: todayISO()\n  });\n  const [rows, setRows] = useState([]);\n\n  // פילטר עובד (לאדמין/מורשה)\n  const [users, setUsers] = useState([]);\n  const [selectedUser, setSelectedUser] = useState('');\n\n  // modal עריכה\n  const [editOpen, setEditOpen] = useState(false);\n  const [editRowState, setEditRowState] = useState(null);\n  const [editForm, setEditForm] = useState({\n    clockIn: '',\n    clockOut: '',\n    notes: ''\n  });\n  const [busy, setBusy] = useState(false);\n  const [toast, setToast] = useState({\n    show: false,\n    type: 'success',\n    title: '',\n    message: ''\n  });\n  const showToast = (type, title, message = '') => setToast({\n    show: true,\n    type,\n    title,\n    message\n  });\n  const closeToast = () => setToast(t => ({\n    ...t,\n    show: false\n  }));\n  const [clock, setClock] = useState(new Date());\n  useEffect(() => {\n    const t = setInterval(() => setClock(new Date()), 1000);\n    return () => clearInterval(t);\n  }, []);\n  const timeText = useMemo(() => clock.toLocaleTimeString(), [clock]);\n  useEffect(() => {\n    (async _m$permissions => {\n      // ⬅️ /me מחזיר את המשתמש עצמו — לא בתוך { user }\n      const m = await api('/api/auth/me');\n      setMe(m);\n      if (m !== null && m !== void 0 && (_m$permissions = m.permissions) !== null && _m$permissions !== void 0 && _m$permissions.attendanceReadAll) {\n        // ⬅️ נתיב תקין לרשימת כל המשתמשים (מוגן ע\"י אדמין)\n        try {\n          const list = await api('/api/admin/users');\n          setUsers(list || []);\n        } catch {}\n      }\n      await refreshToday();\n      await loadReportBy(range.from, range.to, selectedUser);\n    })().catch(e => setErr(e.message));\n  }, []);\n  async function refreshToday() {\n    setErr('');\n    const d = todayISO();\n    const data = await api(`/api/attendance/report?from=${d}&to=${d}`);\n    setToday(data[0] || null);\n  }\n  async function doPost(path, okMsg, errMsg) {\n    if (busy) return;\n    setBusy(true);\n    setErr('');\n    try {\n      const geo = await getGeo();\n      await api(path, {\n        method: 'POST',\n        body: JSON.stringify(geo || {})\n      });\n      await refreshToday();\n      showToast('success', okMsg);\n    } catch (e) {\n      setErr(e.message);\n      showToast('error', errMsg || e.message);\n    } finally {\n      setBusy(false);\n    }\n  }\n  async function loadReport(e) {\n    var _e$preventDefault;\n    e === null || e === void 0 ? void 0 : (_e$preventDefault = e.preventDefault) === null || _e$preventDefault === void 0 ? void 0 : _e$preventDefault.call(e);\n    await loadReportBy(range.from, range.to, selectedUser);\n  }\n  async function loadReportBy(from, to, userId) {\n    setErr('');\n    try {\n      const params = new URLSearchParams({\n        from,\n        to\n      });\n      if (userId) params.set('userId', userId);\n      const data = await api(`/api/attendance/report?${params.toString()}`);\n      setRows(data);\n    } catch (e) {\n      setErr(e.message);\n    }\n  }\n  function logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    window.location.href = '/login';\n  }\n\n  // ===== Exporters =====\n  function exportCSV() {\n    const header = ['date', 'clockIn', 'clockOut', 'regularMinutes', 'overtimeMinutes', 'totalMinutes'];\n    const lines = [header.join(',')].concat(rows.map(r => {\n      var _r$regularMinutes, _r$overtimeMinutes, _r$totalMinutes;\n      return [r.date, r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '', r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '', (_r$regularMinutes = r.regularMinutes) !== null && _r$regularMinutes !== void 0 ? _r$regularMinutes : '', (_r$overtimeMinutes = r.overtimeMinutes) !== null && _r$overtimeMinutes !== void 0 ? _r$overtimeMinutes : '', (_r$totalMinutes = r.totalMinutes) !== null && _r$totalMinutes !== void 0 ? _r$totalMinutes : ''].join(',');\n    }));\n    const blob = new Blob([lines.join('\\n')], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `attendance_${range.from}_${range.to}.csv`;\n    document.body.appendChild(a);\n    a.click();\n    a.remove();\n    URL.revokeObjectURL(url);\n    showToast('success', 'CSV נוצר בהצלחה');\n  }\n  function exportXLSX() {\n    const data = rows.map(r => ({\n      Date: r.date,\n      ClockIn: r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '',\n      ClockOut: r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '',\n      Regular: r.regularMinutes ? fmtMin(r.regularMinutes) : '',\n      Overtime: r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '',\n      Total: r.totalMinutes ? fmtMin(r.totalMinutes) : ''\n    }));\n    const ws = XLSX.utils.json_to_sheet(data);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, 'Report');\n    XLSX.writeFile(wb, `attendance_${range.from}_${range.to}.xlsx`);\n    showToast('success', 'Excel נוצר בהצלחה');\n  }\n  function exportPDF() {\n    const doc = new jsPDF({\n      orientation: 'p',\n      unit: 'pt',\n      format: 'a4'\n    });\n    doc.setFontSize(14);\n    doc.text(`Attendance Report ${range.from} - ${range.to}`, 40, 40);\n    const table = rows.map(r => [r.date, r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '-', r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '-', r.regularMinutes ? fmtMin(r.regularMinutes) : '-', r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '-', r.totalMinutes ? fmtMin(r.totalMinutes) : '-']);\n    doc.autoTable({\n      head: [['Date', 'Clock In', 'Clock Out', 'Regular', 'Overtime', 'Total']],\n      body: table,\n      startY: 60\n    });\n    const y = doc.lastAutoTable.finalY + 30;\n    doc.setFontSize(12);\n    doc.text('Approved by:', 40, y);\n    doc.line(120, y + 2, 300, y + 2);\n    doc.text('(Signature)', 120, y + 18);\n    doc.text(`Generated: ${new Date().toLocaleString()}`, 40, y + 40);\n    doc.save(`attendance_${range.from}_${range.to}.pdf`);\n    showToast('success', 'PDF נשמר');\n  }\n\n  // ===== Edit modal =====\n  function openEdit(r) {\n    var _me$permissions;\n    if (!(me !== null && me !== void 0 && (_me$permissions = me.permissions) !== null && _me$permissions !== void 0 && _me$permissions.attendanceEdit)) return;\n    setEditRowState(r);\n    setEditForm({\n      clockIn: r.clockIn ? new Date(r.clockIn).toISOString().slice(0, 16) : '',\n      clockOut: r.clockOut ? new Date(r.clockOut).toISOString().slice(0, 16) : '',\n      notes: r.notes || ''\n    });\n    setEditOpen(true);\n  }\n  async function saveEdit() {\n    try {\n      const body = {};\n      if (editForm.clockIn) body.clockIn = new Date(editForm.clockIn).toISOString();\n      if (editForm.clockOut) body.clockOut = new Date(editForm.clockOut).toISOString();\n      body.notes = editForm.notes || '';\n      await api(`/api/attendance/${editRowState._id}`, {\n        method: 'PUT',\n        body: JSON.stringify(body)\n      });\n      setEditOpen(false);\n      await loadReportBy(range.from, range.to, selectedUser);\n      await refreshToday();\n      showToast('success', 'עודכן בהצלחה');\n    } catch (e) {\n      showToast('error', e.message);\n    }\n  }\n  const inShift = !!(today !== null && today !== void 0 && today.clockIn) && !(today !== null && today !== void 0 && today.clockOut);\n  const hasOpenBreak = !!((today === null || today === void 0 ? void 0 : today.breaks) || []).find(b => b.start && !b.end);\n  const isAdmin = (me === null || me === void 0 ? void 0 : me.role) === 'admin' || (me === null || me === void 0 ? void 0 : (_me$permissions2 = me.permissions) === null || _me$permissions2 === void 0 ? void 0 : _me$permissions2.manageUsers);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen p-4\",\n    children: [/*#__PURE__*/_jsxDEV(Toast, {\n      show: toast.show,\n      type: toast.type,\n      title: toast.title,\n      message: toast.message,\n      onClose: closeToast\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: editOpen,\n      title: \"\\u05E2\\u05E8\\u05D9\\u05DB\\u05EA \\u05E8\\u05E9\\u05D5\\u05DE\\u05D4\",\n      onClose: () => setEditOpen(false),\n      actions: /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"px-4 py-2 rounded-xl border bg-white\",\n          onClick: () => setEditOpen(false),\n          children: \"\\u05D1\\u05D9\\u05D8\\u05D5\\u05DC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"px-4 py-2 rounded-xl bg-black text-white\",\n          onClick: saveEdit,\n          children: \"\\u05E9\\u05DE\\u05D9\\u05E8\\u05D4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-1\",\n          children: \"Clock In\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"datetime-local\",\n          className: \"border rounded-xl px-3 py-2 w-full\",\n          value: editForm.clockIn,\n          onChange: e => setEditForm(f => ({\n            ...f,\n            clockIn: e.target.value\n          }))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-1\",\n          children: \"Clock Out\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"datetime-local\",\n          className: \"border rounded-xl px-3 py-2 w-full\",\n          value: editForm.clockOut,\n          onChange: e => setEditForm(f => ({\n            ...f,\n            clockOut: e.target.value\n          }))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm mb-1\",\n          children: \"\\u05D4\\u05E2\\u05E8\\u05D5\\u05EA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          className: \"border rounded-xl px-3 py-2 w-full\",\n          rows: 3,\n          value: editForm.notes,\n          onChange: e => setEditForm(f => ({\n            ...f,\n            notes: e.target.value\n          }))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"flex items-center justify-between mb-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"/logo.png\",\n          alt: \"Costoro\",\n          className: \"w-10 h-10 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-semibold text-lg\",\n            children: [\"\\u05E9\\u05DC\\u05D5\\u05DD \", (me === null || me === void 0 ? void 0 : me.name) || '']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-slate-500\",\n            children: me === null || me === void 0 ? void 0 : me.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-3\",\n        children: [isAdmin && /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/admin/users\",\n          className: \"px-3 py-2 rounded-xl bg-white border shadow text-sm\",\n          children: \"\\u05E0\\u05D9\\u05D4\\u05D5\\u05DC \\u05DE\\u05E9\\u05EA\\u05DE\\u05E9\\u05D9\\u05DD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `px-3 py-1 rounded-xl text-white text-sm ${hasOpenBreak ? 'bg-amber-500' : inShift ? 'bg-emerald-600' : 'bg-slate-400'}`,\n          children: hasOpenBreak ? 'בהפסקה' : inShift ? 'במשמרת' : 'לא במשמרת'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"px-3 py-1 rounded-xl bg-white shadow text-sm\",\n          children: timeText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: logout,\n          className: \"px-4 py-2 rounded-xl border bg-white hover:bg-slate-50\",\n          children: \"\\u05D4\\u05EA\\u05E0\\u05EA\\u05E7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 7\n    }, this), err && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-4 text-rose-600\",\n      children: err\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"grid md:grid-cols-2 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold\",\n            children: \"\\u05D3\\u05D5\\u05D7 \\u05DC\\u05E4\\u05D9 \\u05EA\\u05D0\\u05E8\\u05D9\\u05DB\\u05D9\\u05DD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this), ((_me$permissions$expor = me === null || me === void 0 ? void 0 : (_me$permissions3 = me.permissions) === null || _me$permissions3 === void 0 ? void 0 : _me$permissions3.exportReports) !== null && _me$permissions$expor !== void 0 ? _me$permissions$expor : true) && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex gap-3 text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportCSV,\n              className: \"underline\",\n              children: \"CSV\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportXLSX,\n              className: \"underline\",\n              children: \"Excel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: exportPDF,\n              className: \"underline\",\n              children: \"PDF\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: loadReport,\n          className: \"flex flex-wrap items-end gap-3 mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm mb-1\",\n              children: \"\\u05DE\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              className: \"border rounded-xl px-3 py-2\",\n              value: range.from,\n              onChange: e => setRange(v => ({\n                ...v,\n                from: e.target.value\n              })),\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm mb-1\",\n              children: \"\\u05E2\\u05D3 \\u05EA\\u05D0\\u05E8\\u05D9\\u05DA\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              className: \"border rounded-xl px-3 py-2\",\n              value: range.to,\n              onChange: e => setRange(v => ({\n                ...v,\n                to: e.target.value\n              })),\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 13\n          }, this), (me === null || me === void 0 ? void 0 : (_me$permissions4 = me.permissions) === null || _me$permissions4 === void 0 ? void 0 : _me$permissions4.attendanceReadAll) && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm mb-1\",\n              children: \"\\u05E2\\u05D5\\u05D1\\u05D3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"border rounded-xl px-3 py-2 min-w-[220px]\",\n              value: selectedUser,\n              onChange: e => setSelectedUser(e.target.value),\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u2014 \\u05DB\\u05DC\\u05D5\\u05DC/\\u05D4 \\u05D0\\u05EA \\u05E2\\u05E6\\u05DE\\u05D9 \\u2014\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 19\n              }, this), users.map(u => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: u._id || u.id,\n                children: [u.name, \" \\xB7 \", u.department || 'ללא מחלקה']\n              }, u._id || u.id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            type: \"submit\",\n            disabled: busy,\n            children: \"\\u05D8\\u05E2\\u05DF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"overflow-auto\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"min-w-full text-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n              children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                className: \"text-left border-b\",\n                children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 245,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"Clock In\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"Clock Out\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05E8\\u05D2\\u05D9\\u05DC\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05E0\\u05D5\\u05E1\\u05E4\\u05D5\\u05EA\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\",\n                  children: \"\\u05E1\\u05D4\\u05F4\\u05DB\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 19\n                }, this), (me === null || me === void 0 ? void 0 : (_me$permissions5 = me.permissions) === null || _me$permissions5 === void 0 ? void 0 : _me$permissions5.attendanceEdit) && /*#__PURE__*/_jsxDEV(\"th\", {\n                  className: \"py-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 251,\n                  columnNumber: 55\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 243,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n              children: [rows.map(r => {\n                var _me$permissions6;\n                return /*#__PURE__*/_jsxDEV(\"tr\", {\n                  className: \"border-b\",\n                  children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.date\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 257,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 258,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 259,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.regularMinutes ? fmtMin(r.regularMinutes) : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 260,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 261,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: r.totalMinutes ? fmtMin(r.totalMinutes) : '-'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 262,\n                    columnNumber: 21\n                  }, this), (me === null || me === void 0 ? void 0 : (_me$permissions6 = me.permissions) === null || _me$permissions6 === void 0 ? void 0 : _me$permissions6.attendanceEdit) && /*#__PURE__*/_jsxDEV(\"td\", {\n                    className: \"py-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"px-3 py-1 rounded-xl border\",\n                      onClick: () => openEdit(r),\n                      children: \"\\u05E2\\u05E8\\u05D5\\u05DA\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 265,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 264,\n                    columnNumber: 23\n                  }, this)]\n                }, r._id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 256,\n                  columnNumber: 19\n                }, this);\n              }), !rows.length && /*#__PURE__*/_jsxDEV(\"tr\", {\n                children: /*#__PURE__*/_jsxDEV(\"td\", {\n                  className: \"py-4 text-slate-400\",\n                  colSpan: 7,\n                  children: \"\\u05D0\\u05D9\\u05DF \\u05E0\\u05EA\\u05D5\\u05E0\\u05D9\\u05DD \\u05DC\\u05EA\\u05E7\\u05D5\\u05E4\\u05D4 \\u05D6\\u05D5\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 38\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 34\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-2xl shadow p-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between mb-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-xl font-semibold\",\n            children: \"\\u05D4\\u05D9\\u05D5\\u05DD\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-slate-500\",\n            children: inShift ? 'במשמרת פעילה' : 'לא במשמרת'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-2 flex-wrap mb-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || inShift,\n            onClick: () => doPost('/api/attendance/clockin', 'Clock In בוצע!'),\n            children: \"Clock In\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || !inShift,\n            onClick: () => doPost('/api/attendance/clockout', 'Clock Out בוצע!'),\n            children: \"Clock Out\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || !inShift || hasOpenBreak,\n            onClick: () => doPost('/api/attendance/break/start', 'הפסקה התחילה'),\n            children: \"Start Break\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn\",\n            disabled: busy || !inShift || !hasOpenBreak,\n            onClick: () => doPost('/api/attendance/break/end', 'הפסקה הסתיימה'),\n            children: \"End Break\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Clock In:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.clockIn ? new Date(today.clockIn).toLocaleTimeString() : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"Clock Out:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.clockOut ? new Date(today.clockOut).toLocaleTimeString() : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05E1\\u05D4\\u05F4\\u05DB:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.totalMinutes ? fmtMin(today.totalMinutes) : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 293,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05E8\\u05D2\\u05D9\\u05DC:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.regularMinutes ? fmtMin(today.regularMinutes) : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05E0\\u05D5\\u05E1\\u05E4\\u05D5\\u05EA:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 18\n            }, this), \" \", today !== null && today !== void 0 && today.overtimeMinutes ? fmtMin(today.overtimeMinutes) : '-']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"b\", {\n              children: \"\\u05D4\\u05E4\\u05E1\\u05E7\\u05D5\\u05EA:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              className: \"list-disc pr-5\",\n              children: ((today === null || today === void 0 ? void 0 : today.breaks) || []).map((b, i) => /*#__PURE__*/_jsxDEV(\"li\", {\n                children: [b.start ? new Date(b.start).toLocaleTimeString() : '-', \" \\u2192 \", b.end ? new Date(b.end).toLocaleTimeString() : '—']\n              }, i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 300,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 277,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `.btn{background:black;color:white;border-radius:0.75rem;padding:0.6rem 1rem}.btn[disabled]{opacity:.4;cursor:not-allowed}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 5\n  }, this);\n}\n_s(Dashboard, \"DqMSGwSgLb47TknwMoNS7Ld7V2k=\");\n_c = Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","useMemo","api","Toast","Modal","jsPDF","XLSX","jsxDEV","_jsxDEV","Fragment","_Fragment","fmtMin","n","h","Math","floor","m","todayISO","d","Date","off","getTimezoneOffset","z","getTime","toISOString","slice","getGeo","navigator","Promise","resolve","geolocation","getCurrentPosition","pos","lat","coords","latitude","lng","longitude","enableHighAccuracy","timeout","maximumAge","Dashboard","_s","_me$permissions2","_me$permissions$expor","_me$permissions3","_me$permissions4","_me$permissions5","me","setMe","today","setToday","err","setErr","range","setRange","from","to","rows","setRows","users","setUsers","selectedUser","setSelectedUser","editOpen","setEditOpen","editRowState","setEditRowState","editForm","setEditForm","clockIn","clockOut","notes","busy","setBusy","toast","setToast","show","type","title","message","showToast","closeToast","t","clock","setClock","setInterval","clearInterval","timeText","toLocaleTimeString","_m$permissions","permissions","attendanceReadAll","list","refreshToday","loadReportBy","catch","e","data","doPost","path","okMsg","errMsg","geo","method","body","JSON","stringify","loadReport","_e$preventDefault","preventDefault","call","userId","params","URLSearchParams","set","toString","logout","localStorage","removeItem","window","location","href","exportCSV","header","lines","join","concat","map","r","_r$regularMinutes","_r$overtimeMinutes","_r$totalMinutes","date","regularMinutes","overtimeMinutes","totalMinutes","blob","Blob","url","URL","createObjectURL","a","document","createElement","download","appendChild","click","remove","revokeObjectURL","exportXLSX","ClockIn","ClockOut","Regular","Overtime","Total","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","writeFile","exportPDF","doc","orientation","unit","format","setFontSize","text","table","autoTable","head","startY","y","lastAutoTable","finalY","line","toLocaleString","save","openEdit","_me$permissions","attendanceEdit","saveEdit","_id","inShift","hasOpenBreak","breaks","find","b","start","end","isAdmin","role","manageUsers","className","children","onClose","fileName","_jsxFileName","lineNumber","columnNumber","open","actions","onClick","value","onChange","f","target","src","alt","name","email","exportReports","onSubmit","v","required","u","id","department","disabled","_me$permissions6","length","colSpan","i","_c","$RefreshReg$"],"sources":["C:/Users/user/Desktop/timewatch-clone/client/src/pages/Dashboard.js"],"sourcesContent":["// client/src/pages/Dashboard.js\nimport React, { useEffect, useState, useMemo } from 'react';\nimport { api } from '../api';\nimport Toast from '../components/Toast';\nimport Modal from '../components/Modal';\nimport jsPDF from 'jspdf';\nimport 'jspdf-autotable';\nimport * as XLSX from 'xlsx';\n\nfunction fmtMin(n){ const h=Math.floor(n/60); const m=n%60; return `${h}ש ${m}ד`; }\nfunction todayISO(){ const d=new Date(); const off=d.getTimezoneOffset(); const z=new Date(d.getTime()-off*60000); return z.toISOString().slice(0,10); }\nasync function getGeo(){ if(!('geolocation' in navigator)) return null;\n  return new Promise(resolve=>{ navigator.geolocation.getCurrentPosition(\n    pos=>resolve({lat:pos.coords.latitude,lng:pos.coords.longitude}),\n    ()=>resolve(null), { enableHighAccuracy:false, timeout:3000, maximumAge:60000 }\n  );});\n}\n\nexport default function Dashboard(){\n  const [me,setMe]=useState(null);\n  const [today,setToday]=useState(null);\n  const [err,setErr]=useState('');\n  const [range,setRange]=useState({ from: todayISO(), to: todayISO() });\n  const [rows,setRows]=useState([]);\n\n  // פילטר עובד (לאדמין/מורשה)\n  const [users,setUsers]=useState([]);\n  const [selectedUser,setSelectedUser]=useState('');\n\n  // modal עריכה\n  const [editOpen,setEditOpen]=useState(false);\n  const [editRowState,setEditRowState]=useState(null);\n  const [editForm,setEditForm]=useState({ clockIn:'', clockOut:'', notes:'' });\n\n  const [busy,setBusy]=useState(false);\n  const [toast,setToast]=useState({ show:false, type:'success', title:'', message:'' });\n  const showToast=(type,title,message='')=>setToast({ show:true, type, title, message });\n  const closeToast=()=>setToast(t=>({ ...t, show:false }));\n\n  const [clock,setClock]=useState(new Date());\n  useEffect(()=>{ const t=setInterval(()=>setClock(new Date()),1000); return ()=>clearInterval(t); },[]);\n  const timeText=useMemo(()=>clock.toLocaleTimeString(),[clock]);\n\n  useEffect(()=>{ (async()=>{\n      // ⬅️ /me מחזיר את המשתמש עצמו — לא בתוך { user }\n      const m=await api('/api/auth/me'); setMe(m);\n\n      if (m?.permissions?.attendanceReadAll) {\n        // ⬅️ נתיב תקין לרשימת כל המשתמשים (מוגן ע\"י אדמין)\n        try { const list = await api('/api/admin/users'); setUsers(list || []); } catch {}\n      }\n      await refreshToday();\n      await loadReportBy(range.from, range.to, selectedUser);\n  })().catch(e=>setErr(e.message)); },[]);\n\n  async function refreshToday(){\n    setErr('');\n    const d=todayISO();\n    const data=await api(`/api/attendance/report?from=${d}&to=${d}`);\n    setToday(data[0]||null);\n  }\n\n  async function doPost(path, okMsg, errMsg){\n    if (busy) return; setBusy(true); setErr('');\n    try{\n      const geo = await getGeo();\n      await api(path, { method:'POST', body: JSON.stringify(geo || {}) });\n      await refreshToday();\n      showToast('success', okMsg);\n    }catch(e){ setErr(e.message); showToast('error', errMsg || e.message); }\n    finally{ setBusy(false); }\n  }\n\n  async function loadReport(e){ e?.preventDefault?.(); await loadReportBy(range.from, range.to, selectedUser); }\n\n  async function loadReportBy(from,to,userId){\n    setErr('');\n    try{\n      const params = new URLSearchParams({ from, to });\n      if (userId) params.set('userId', userId);\n      const data=await api(`/api/attendance/report?${params.toString()}`);\n      setRows(data);\n    }catch(e){ setErr(e.message); }\n  }\n\n  function logout(){\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    window.location.href='/login';\n  }\n\n  // ===== Exporters =====\n  function exportCSV(){\n    const header=['date','clockIn','clockOut','regularMinutes','overtimeMinutes','totalMinutes'];\n    const lines=[header.join(',')].concat(\n      rows.map(r=>[r.date, r.clockIn?new Date(r.clockIn).toLocaleTimeString():'', r.clockOut?new Date(r.clockOut).toLocaleTimeString():'', r.regularMinutes??'', r.overtimeMinutes??'', r.totalMinutes??''].join(','))\n    );\n    const blob=new Blob([lines.join('\\n')],{type:'text/csv;charset=utf-8;'}); const url=URL.createObjectURL(blob);\n    const a=document.createElement('a'); a.href=url; a.download=`attendance_${range.from}_${range.to}.csv`; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);\n    showToast('success','CSV נוצר בהצלחה');\n  }\n  function exportXLSX(){\n    const data=rows.map(r=>({Date:r.date, ClockIn:r.clockIn?new Date(r.clockIn).toLocaleTimeString():'', ClockOut:r.clockOut?new Date(r.clockOut).toLocaleTimeString():'', Regular:r.regularMinutes?fmtMin(r.regularMinutes):'', Overtime:r.overtimeMinutes?fmtMin(r.overtimeMinutes):'', Total:r.totalMinutes?fmtMin(r.totalMinutes):''}));\n    const ws=XLSX.utils.json_to_sheet(data); const wb=XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb,ws,'Report'); XLSX.writeFile(wb,`attendance_${range.from}_${range.to}.xlsx`); showToast('success','Excel נוצר בהצלחה');\n  }\n  function exportPDF(){\n    const doc=new jsPDF({orientation:'p',unit:'pt',format:'a4'}); doc.setFontSize(14); doc.text(`Attendance Report ${range.from} - ${range.to}`,40,40);\n    const table=rows.map(r=>[r.date, r.clockIn?new Date(r.clockIn).toLocaleTimeString():'-', r.clockOut?new Date(r.clockOut).toLocaleTimeString():'-', r.regularMinutes?fmtMin(r.regularMinutes):'-', r.overtimeMinutes?fmtMin(r.overtimeMinutes):'-', r.totalMinutes?fmtMin(r.totalMinutes):'-']);\n    doc.autoTable({ head:[['Date','Clock In','Clock Out','Regular','Overtime','Total']], body:table, startY:60 });\n    const y=doc.lastAutoTable.finalY+30; doc.setFontSize(12); doc.text('Approved by:',40,y); doc.line(120,y+2,300,y+2); doc.text('(Signature)',120,y+18); doc.text(`Generated: ${new Date().toLocaleString()}`,40,y+40);\n    doc.save(`attendance_${range.from}_${range.to}.pdf`); showToast('success','PDF נשמר');\n  }\n\n  // ===== Edit modal =====\n  function openEdit(r){\n    if (!me?.permissions?.attendanceEdit) return;\n    setEditRowState(r);\n    setEditForm({\n      clockIn: r.clockIn ? new Date(r.clockIn).toISOString().slice(0,16) : '',\n      clockOut: r.clockOut ? new Date(r.clockOut).toISOString().slice(0,16) : '',\n      notes: r.notes || ''\n    });\n    setEditOpen(true);\n  }\n  async function saveEdit(){\n    try{\n      const body={};\n      if (editForm.clockIn) body.clockIn = new Date(editForm.clockIn).toISOString();\n      if (editForm.clockOut) body.clockOut = new Date(editForm.clockOut).toISOString();\n      body.notes = editForm.notes || '';\n      await api(`/api/attendance/${editRowState._id}`, { method:'PUT', body: JSON.stringify(body) });\n      setEditOpen(false);\n      await loadReportBy(range.from, range.to, selectedUser);\n      await refreshToday();\n      showToast('success','עודכן בהצלחה');\n    }catch(e){ showToast('error', e.message); }\n  }\n\n  const inShift=!!today?.clockIn && !today?.clockOut;\n  const hasOpenBreak=!!(today?.breaks||[]).find(b=>b.start && !b.end);\n  const isAdmin = me?.role === 'admin' || me?.permissions?.manageUsers;\n\n  return (\n    <div className=\"min-h-screen p-4\">\n      <Toast show={toast.show} type={toast.type} title={toast.title} message={toast.message} onClose={closeToast} />\n\n      {/* Modal עריכה */}\n      <Modal\n        open={editOpen}\n        title=\"עריכת רשומה\"\n        onClose={()=>setEditOpen(false)}\n        actions={\n          <>\n            <button className=\"px-4 py-2 rounded-xl border bg-white\" onClick={()=>setEditOpen(false)}>ביטול</button>\n            <button className=\"px-4 py-2 rounded-xl bg-black text-white\" onClick={saveEdit}>שמירה</button>\n          </>\n        }\n      >\n        <div>\n          <label className=\"block text-sm mb-1\">Clock In</label>\n          <input type=\"datetime-local\" className=\"border rounded-xl px-3 py-2 w-full\"\n                 value={editForm.clockIn} onChange={e=>setEditForm(f=>({...f,clockIn:e.target.value}))}/>\n        </div>\n        <div>\n          <label className=\"block text-sm mb-1\">Clock Out</label>\n          <input type=\"datetime-local\" className=\"border rounded-xl px-3 py-2 w-full\"\n                 value={editForm.clockOut} onChange={e=>setEditForm(f=>({...f,clockOut:e.target.value}))}/>\n        </div>\n        <div>\n          <label className=\"block text-sm mb-1\">הערות</label>\n          <textarea className=\"border rounded-xl px-3 py-2 w-full\" rows={3}\n                    value={editForm.notes} onChange={e=>setEditForm(f=>({...f,notes:e.target.value}))}/>\n        </div>\n      </Modal>\n\n      <header className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-3\">\n          <img src=\"/logo.png\" alt=\"Costoro\" className=\"w-10 h-10 rounded-md\" />\n          <div>\n            <div className=\"font-semibold text-lg\">שלום {me?.name || ''}</div>\n            <div className=\"text-sm text-slate-500\">{me?.email}</div>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          {isAdmin && (\n            <a href=\"/admin/users\" className=\"px-3 py-2 rounded-xl bg-white border shadow text-sm\">ניהול משתמשים</a>\n          )}\n          <div className={`px-3 py-1 rounded-xl text-white text-sm ${hasOpenBreak ? 'bg-amber-500' : inShift ? 'bg-emerald-600' : 'bg-slate-400'}`}>\n            {hasOpenBreak ? 'בהפסקה' : inShift ? 'במשמרת' : 'לא במשמרת'}\n          </div>\n          <div className=\"px-3 py-1 rounded-xl bg-white shadow text-sm\">{timeText}</div>\n          <button onClick={logout} className=\"px-4 py-2 rounded-xl border bg-white hover:bg-slate-50\">התנתק</button>\n        </div>\n      </header>\n\n      {err && <div className=\"mb-4 text-rose-600\">{err}</div>}\n\n      <main className=\"grid md:grid-cols-2 gap-6\">\n        {/* דוחות */}\n        <div className=\"bg-white rounded-2xl shadow p-5\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h2 className=\"text-xl font-semibold\">דוח לפי תאריכים</h2>\n            {(me?.permissions?.exportReports ?? true) && (\n              <div className=\"flex gap-3 text-sm\">\n                <button onClick={exportCSV} className=\"underline\">CSV</button>\n                <button onClick={exportXLSX} className=\"underline\">Excel</button>\n                <button onClick={exportPDF} className=\"underline\">PDF</button>\n              </div>\n            )}\n          </div>\n\n          <form onSubmit={loadReport} className=\"flex flex-wrap items-end gap-3 mb-4\">\n            <div>\n              <label className=\"block text-sm mb-1\">מתאריך</label>\n              <input type=\"date\" className=\"border rounded-xl px-3 py-2\" value={range.from} onChange={(e)=>setRange(v=>({...v, from:e.target.value}))} required />\n            </div>\n            <div>\n              <label className=\"block text-sm mb-1\">עד תאריך</label>\n              <input type=\"date\" className=\"border rounded-xl px-3 py-2\" value={range.to} onChange={(e)=>setRange(v=>({...v, to:e.target.value}))} required />\n            </div>\n\n            {me?.permissions?.attendanceReadAll && (\n              <div>\n                <label className=\"block text-sm mb-1\">עובד</label>\n                <select className=\"border rounded-xl px-3 py-2 min-w-[220px]\"\n                        value={selectedUser} onChange={(e)=>setSelectedUser(e.target.value)}>\n                  <option value=\"\">— כלול/ה את עצמי —</option>\n                  {users.map(u=>(\n                    <option key={u._id || u.id} value={u._id || u.id}>\n                      {u.name} · {u.department || 'ללא מחלקה'}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n\n            <button className=\"btn\" type=\"submit\" disabled={busy}>טען</button>\n          </form>\n\n          <div className=\"overflow-auto\">\n            <table className=\"min-w-full text-sm\">\n              <thead>\n                <tr className=\"text-left border-b\">\n                  <th className=\"py-2\">תאריך</th>\n                  <th className=\"py-2\">Clock In</th>\n                  <th className=\"py-2\">Clock Out</th>\n                  <th className=\"py-2\">רגיל</th>\n                  <th className=\"py-2\">נוספות</th>\n                  <th className=\"py-2\">סה״כ</th>\n                  {me?.permissions?.attendanceEdit && <th className=\"py-2\"></th>}\n                </tr>\n              </thead>\n              <tbody>\n                {rows.map(r=>(\n                  <tr key={r._id} className=\"border-b\">\n                    <td className=\"py-2\">{r.date}</td>\n                    <td className=\"py-2\">{r.clockIn ? new Date(r.clockIn).toLocaleTimeString() : '-'}</td>\n                    <td className=\"py-2\">{r.clockOut ? new Date(r.clockOut).toLocaleTimeString() : '-'}</td>\n                    <td className=\"py-2\">{r.regularMinutes ? fmtMin(r.regularMinutes) : '-'}</td>\n                    <td className=\"py-2\">{r.overtimeMinutes ? fmtMin(r.overtimeMinutes) : '-'}</td>\n                    <td className=\"py-2\">{r.totalMinutes ? fmtMin(r.totalMinutes) : '-'}</td>\n                    {me?.permissions?.attendanceEdit && (\n                      <td className=\"py-2\">\n                        <button className=\"px-3 py-1 rounded-xl border\" onClick={()=>openEdit(r)}>ערוך</button>\n                      </td>\n                    )}\n                  </tr>\n                ))}\n                {!rows.length && <tr><td className=\"py-4 text-slate-400\" colSpan={7}>אין נתונים לתקופה זו</td></tr>}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/* היום */}\n        <div className=\"bg-white rounded-2xl shadow p-5\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h2 className=\"text-xl font-semibold\">היום</h2>\n            <div className=\"text-xs text-slate-500\">{inShift ? 'במשמרת פעילה' : 'לא במשמרת'}</div>\n          </div>\n\n          <div className=\"flex gap-2 flex-wrap mb-4\">\n            <button className=\"btn\" disabled={busy || inShift} onClick={()=>doPost('/api/attendance/clockin','Clock In בוצע!')}>Clock In</button>\n            <button className=\"btn\" disabled={busy || !inShift} onClick={()=>doPost('/api/attendance/clockout','Clock Out בוצע!')}>Clock Out</button>\n            <button className=\"btn\" disabled={busy || !inShift || hasOpenBreak} onClick={()=>doPost('/api/attendance/break/start','הפסקה התחילה')}>Start Break</button>\n            <button className=\"btn\" disabled={busy || !inShift || !hasOpenBreak} onClick={()=>doPost('/api/attendance/break/end','הפסקה הסתיימה')}>End Break</button>\n          </div>\n\n          <div className=\"space-y-2\">\n            <div><b>Clock In:</b> {today?.clockIn ? new Date(today.clockIn).toLocaleTimeString() : '-'}</div>\n            <div><b>Clock Out:</b> {today?.clockOut ? new Date(today.clockOut).toLocaleTimeString() : '-'}</div>\n            <div><b>סה״כ:</b> {today?.totalMinutes ? fmtMin(today.totalMinutes) : '-'}</div>\n            <div><b>רגיל:</b> {today?.regularMinutes ? fmtMin(today.regularMinutes) : '-'}</div>\n            <div><b>נוספות:</b> {today?.overtimeMinutes ? fmtMin(today.overtimeMinutes) : '-'}</div>\n            <div>\n              <b>הפסקות:</b>\n              <ul className=\"list-disc pr-5\">\n                {(today?.breaks || []).map((b,i)=>(\n                  <li key={i}>{b.start?new Date(b.start).toLocaleTimeString():'-'} → {b.end?new Date(b.end).toLocaleTimeString():'—'}</li>\n                ))}\n              </ul>\n            </div>\n          </div>\n        </div>\n      </main>\n\n      <style>{`.btn{background:black;color:white;border-radius:0.75rem;padding:0.6rem 1rem}.btn[disabled]{opacity:.4;cursor:not-allowed}`}</style>\n    </div>\n  );\n}\n"],"mappings":";;AAAA;AACA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,OAAO;AAC3D,SAASC,GAAG,QAAQ,QAAQ;AAC5B,OAAOC,KAAK,MAAM,qBAAqB;AACvC,OAAOC,KAAK,MAAM,qBAAqB;AACvC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAO,iBAAiB;AACxB,OAAO,KAAKC,IAAI,MAAM,MAAM;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE7B,SAASC,MAAMA,CAACC,CAAC,EAAC;EAAE,MAAMC,CAAC,GAACC,IAAI,CAACC,KAAK,CAACH,CAAC,GAAC,EAAE,CAAC;EAAE,MAAMI,CAAC,GAACJ,CAAC,GAAC,EAAE;EAAE,OAAO,GAAGC,CAAC,KAAKG,CAAC,GAAG;AAAE;AAClF,SAASC,QAAQA,CAAA,EAAE;EAAE,MAAMC,CAAC,GAAC,IAAIC,IAAI,CAAC,CAAC;EAAE,MAAMC,GAAG,GAACF,CAAC,CAACG,iBAAiB,CAAC,CAAC;EAAE,MAAMC,CAAC,GAAC,IAAIH,IAAI,CAACD,CAAC,CAACK,OAAO,CAAC,CAAC,GAACH,GAAG,GAAC,KAAK,CAAC;EAAE,OAAOE,CAAC,CAACE,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC;AAAE;AACvJ,eAAeC,MAAMA,CAAA,EAAE;EAAE,IAAG,EAAE,aAAa,IAAIC,SAAS,CAAC,EAAE,OAAO,IAAI;EACpE,OAAO,IAAIC,OAAO,CAACC,OAAO,IAAE;IAAEF,SAAS,CAACG,WAAW,CAACC,kBAAkB,CACpEC,GAAG,IAAEH,OAAO,CAAC;MAACI,GAAG,EAACD,GAAG,CAACE,MAAM,CAACC,QAAQ;MAACC,GAAG,EAACJ,GAAG,CAACE,MAAM,CAACG;IAAS,CAAC,CAAC,EAChE,MAAIR,OAAO,CAAC,IAAI,CAAC,EAAE;MAAES,kBAAkB,EAAC,KAAK;MAAEC,OAAO,EAAC,IAAI;MAAEC,UAAU,EAAC;IAAM,CAChF,CAAC;EAAC,CAAC,CAAC;AACN;AAEA,eAAe,SAASC,SAASA,CAAA,EAAE;EAAAC,EAAA;EAAA,IAAAC,gBAAA,EAAAC,qBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA;EACjC,MAAM,CAACC,EAAE,EAACC,KAAK,CAAC,GAACjD,QAAQ,CAAC,IAAI,CAAC;EAC/B,MAAM,CAACkD,KAAK,EAACC,QAAQ,CAAC,GAACnD,QAAQ,CAAC,IAAI,CAAC;EACrC,MAAM,CAACoD,GAAG,EAACC,MAAM,CAAC,GAACrD,QAAQ,CAAC,EAAE,CAAC;EAC/B,MAAM,CAACsD,KAAK,EAACC,QAAQ,CAAC,GAACvD,QAAQ,CAAC;IAAEwD,IAAI,EAAEvC,QAAQ,CAAC,CAAC;IAAEwC,EAAE,EAAExC,QAAQ,CAAC;EAAE,CAAC,CAAC;EACrE,MAAM,CAACyC,IAAI,EAACC,OAAO,CAAC,GAAC3D,QAAQ,CAAC,EAAE,CAAC;;EAEjC;EACA,MAAM,CAAC4D,KAAK,EAACC,QAAQ,CAAC,GAAC7D,QAAQ,CAAC,EAAE,CAAC;EACnC,MAAM,CAAC8D,YAAY,EAACC,eAAe,CAAC,GAAC/D,QAAQ,CAAC,EAAE,CAAC;;EAEjD;EACA,MAAM,CAACgE,QAAQ,EAACC,WAAW,CAAC,GAACjE,QAAQ,CAAC,KAAK,CAAC;EAC5C,MAAM,CAACkE,YAAY,EAACC,eAAe,CAAC,GAACnE,QAAQ,CAAC,IAAI,CAAC;EACnD,MAAM,CAACoE,QAAQ,EAACC,WAAW,CAAC,GAACrE,QAAQ,CAAC;IAAEsE,OAAO,EAAC,EAAE;IAAEC,QAAQ,EAAC,EAAE;IAAEC,KAAK,EAAC;EAAG,CAAC,CAAC;EAE5E,MAAM,CAACC,IAAI,EAACC,OAAO,CAAC,GAAC1E,QAAQ,CAAC,KAAK,CAAC;EACpC,MAAM,CAAC2E,KAAK,EAACC,QAAQ,CAAC,GAAC5E,QAAQ,CAAC;IAAE6E,IAAI,EAAC,KAAK;IAAEC,IAAI,EAAC,SAAS;IAAEC,KAAK,EAAC,EAAE;IAAEC,OAAO,EAAC;EAAG,CAAC,CAAC;EACrF,MAAMC,SAAS,GAACA,CAACH,IAAI,EAACC,KAAK,EAACC,OAAO,GAAC,EAAE,KAAGJ,QAAQ,CAAC;IAAEC,IAAI,EAAC,IAAI;IAAEC,IAAI;IAAEC,KAAK;IAAEC;EAAQ,CAAC,CAAC;EACtF,MAAME,UAAU,GAACA,CAAA,KAAIN,QAAQ,CAACO,CAAC,KAAG;IAAE,GAAGA,CAAC;IAAEN,IAAI,EAAC;EAAM,CAAC,CAAC,CAAC;EAExD,MAAM,CAACO,KAAK,EAACC,QAAQ,CAAC,GAACrF,QAAQ,CAAC,IAAImB,IAAI,CAAC,CAAC,CAAC;EAC3CpB,SAAS,CAAC,MAAI;IAAE,MAAMoF,CAAC,GAACG,WAAW,CAAC,MAAID,QAAQ,CAAC,IAAIlE,IAAI,CAAC,CAAC,CAAC,EAAC,IAAI,CAAC;IAAE,OAAO,MAAIoE,aAAa,CAACJ,CAAC,CAAC;EAAE,CAAC,EAAC,EAAE,CAAC;EACtG,MAAMK,QAAQ,GAACvF,OAAO,CAAC,MAAImF,KAAK,CAACK,kBAAkB,CAAC,CAAC,EAAC,CAACL,KAAK,CAAC,CAAC;EAE9DrF,SAAS,CAAC,MAAI;IAAE,CAAC,MAAA2F,cAAA,IAAS;MACtB;MACA,MAAM1E,CAAC,GAAC,MAAMd,GAAG,CAAC,cAAc,CAAC;MAAE+C,KAAK,CAACjC,CAAC,CAAC;MAE3C,IAAIA,CAAC,aAADA,CAAC,gBAAA0E,cAAA,GAAD1E,CAAC,CAAE2E,WAAW,cAAAD,cAAA,eAAdA,cAAA,CAAgBE,iBAAiB,EAAE;QACrC;QACA,IAAI;UAAE,MAAMC,IAAI,GAAG,MAAM3F,GAAG,CAAC,kBAAkB,CAAC;UAAE2D,QAAQ,CAACgC,IAAI,IAAI,EAAE,CAAC;QAAE,CAAC,CAAC,MAAM,CAAC;MACnF;MACA,MAAMC,YAAY,CAAC,CAAC;MACpB,MAAMC,YAAY,CAACzC,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,EAAE,EAAEK,YAAY,CAAC;IAC1D,CAAC,EAAE,CAAC,CAACkC,KAAK,CAACC,CAAC,IAAE5C,MAAM,CAAC4C,CAAC,CAACjB,OAAO,CAAC,CAAC;EAAE,CAAC,EAAC,EAAE,CAAC;EAEvC,eAAec,YAAYA,CAAA,EAAE;IAC3BzC,MAAM,CAAC,EAAE,CAAC;IACV,MAAMnC,CAAC,GAACD,QAAQ,CAAC,CAAC;IAClB,MAAMiF,IAAI,GAAC,MAAMhG,GAAG,CAAC,+BAA+BgB,CAAC,OAAOA,CAAC,EAAE,CAAC;IAChEiC,QAAQ,CAAC+C,IAAI,CAAC,CAAC,CAAC,IAAE,IAAI,CAAC;EACzB;EAEA,eAAeC,MAAMA,CAACC,IAAI,EAAEC,KAAK,EAAEC,MAAM,EAAC;IACxC,IAAI7B,IAAI,EAAE;IAAQC,OAAO,CAAC,IAAI,CAAC;IAAErB,MAAM,CAAC,EAAE,CAAC;IAC3C,IAAG;MACD,MAAMkD,GAAG,GAAG,MAAM7E,MAAM,CAAC,CAAC;MAC1B,MAAMxB,GAAG,CAACkG,IAAI,EAAE;QAAEI,MAAM,EAAC,MAAM;QAAEC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,GAAG,IAAI,CAAC,CAAC;MAAE,CAAC,CAAC;MACnE,MAAMT,YAAY,CAAC,CAAC;MACpBb,SAAS,CAAC,SAAS,EAAEoB,KAAK,CAAC;IAC7B,CAAC,QAAMJ,CAAC,EAAC;MAAE5C,MAAM,CAAC4C,CAAC,CAACjB,OAAO,CAAC;MAAEC,SAAS,CAAC,OAAO,EAAEqB,MAAM,IAAIL,CAAC,CAACjB,OAAO,CAAC;IAAE,CAAC,SACjE;MAAEN,OAAO,CAAC,KAAK,CAAC;IAAE;EAC3B;EAEA,eAAekC,UAAUA,CAACX,CAAC,EAAC;IAAA,IAAAY,iBAAA;IAAEZ,CAAC,aAADA,CAAC,wBAAAY,iBAAA,GAADZ,CAAC,CAAEa,cAAc,cAAAD,iBAAA,uBAAjBA,iBAAA,CAAAE,IAAA,CAAAd,CAAoB,CAAC;IAAE,MAAMF,YAAY,CAACzC,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,EAAE,EAAEK,YAAY,CAAC;EAAE;EAE7G,eAAeiC,YAAYA,CAACvC,IAAI,EAACC,EAAE,EAACuD,MAAM,EAAC;IACzC3D,MAAM,CAAC,EAAE,CAAC;IACV,IAAG;MACD,MAAM4D,MAAM,GAAG,IAAIC,eAAe,CAAC;QAAE1D,IAAI;QAAEC;MAAG,CAAC,CAAC;MAChD,IAAIuD,MAAM,EAAEC,MAAM,CAACE,GAAG,CAAC,QAAQ,EAAEH,MAAM,CAAC;MACxC,MAAMd,IAAI,GAAC,MAAMhG,GAAG,CAAC,0BAA0B+G,MAAM,CAACG,QAAQ,CAAC,CAAC,EAAE,CAAC;MACnEzD,OAAO,CAACuC,IAAI,CAAC;IACf,CAAC,QAAMD,CAAC,EAAC;MAAE5C,MAAM,CAAC4C,CAAC,CAACjB,OAAO,CAAC;IAAE;EAChC;EAEA,SAASqC,MAAMA,CAAA,EAAE;IACfC,YAAY,CAACC,UAAU,CAAC,OAAO,CAAC;IAChCD,YAAY,CAACC,UAAU,CAAC,MAAM,CAAC;IAC/BC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAC,QAAQ;EAC/B;;EAEA;EACA,SAASC,SAASA,CAAA,EAAE;IAClB,MAAMC,MAAM,GAAC,CAAC,MAAM,EAAC,SAAS,EAAC,UAAU,EAAC,gBAAgB,EAAC,iBAAiB,EAAC,cAAc,CAAC;IAC5F,MAAMC,KAAK,GAAC,CAACD,MAAM,CAACE,IAAI,CAAC,GAAG,CAAC,CAAC,CAACC,MAAM,CACnCrE,IAAI,CAACsE,GAAG,CAACC,CAAC;MAAA,IAAAC,iBAAA,EAAAC,kBAAA,EAAAC,eAAA;MAAA,OAAE,CAACH,CAAC,CAACI,IAAI,EAAEJ,CAAC,CAAC3D,OAAO,GAAC,IAAInD,IAAI,CAAC8G,CAAC,CAAC3D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAC,EAAE,EAAEwC,CAAC,CAAC1D,QAAQ,GAAC,IAAIpD,IAAI,CAAC8G,CAAC,CAAC1D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAC,EAAE,GAAAyC,iBAAA,GAAED,CAAC,CAACK,cAAc,cAAAJ,iBAAA,cAAAA,iBAAA,GAAE,EAAE,GAAAC,kBAAA,GAAEF,CAAC,CAACM,eAAe,cAAAJ,kBAAA,cAAAA,kBAAA,GAAE,EAAE,GAAAC,eAAA,GAAEH,CAAC,CAACO,YAAY,cAAAJ,eAAA,cAAAA,eAAA,GAAE,EAAE,CAAC,CAACN,IAAI,CAAC,GAAG,CAAC;IAAA,EACjN,CAAC;IACD,MAAMW,IAAI,GAAC,IAAIC,IAAI,CAAC,CAACb,KAAK,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,EAAC;MAAChD,IAAI,EAAC;IAAyB,CAAC,CAAC;IAAE,MAAM6D,GAAG,GAACC,GAAG,CAACC,eAAe,CAACJ,IAAI,CAAC;IAC7G,MAAMK,CAAC,GAACC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;IAAEF,CAAC,CAACpB,IAAI,GAACiB,GAAG;IAAEG,CAAC,CAACG,QAAQ,GAAC,cAAc3F,KAAK,CAACE,IAAI,IAAIF,KAAK,CAACG,EAAE,MAAM;IAAEsF,QAAQ,CAACtC,IAAI,CAACyC,WAAW,CAACJ,CAAC,CAAC;IAAEA,CAAC,CAACK,KAAK,CAAC,CAAC;IAAEL,CAAC,CAACM,MAAM,CAAC,CAAC;IAAER,GAAG,CAACS,eAAe,CAACV,GAAG,CAAC;IACrL1D,SAAS,CAAC,SAAS,EAAC,iBAAiB,CAAC;EACxC;EACA,SAASqE,UAAUA,CAAA,EAAE;IACnB,MAAMpD,IAAI,GAACxC,IAAI,CAACsE,GAAG,CAACC,CAAC,KAAG;MAAC9G,IAAI,EAAC8G,CAAC,CAACI,IAAI;MAAEkB,OAAO,EAACtB,CAAC,CAAC3D,OAAO,GAAC,IAAInD,IAAI,CAAC8G,CAAC,CAAC3D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAC,EAAE;MAAE+D,QAAQ,EAACvB,CAAC,CAAC1D,QAAQ,GAAC,IAAIpD,IAAI,CAAC8G,CAAC,CAAC1D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAC,EAAE;MAAEgE,OAAO,EAACxB,CAAC,CAACK,cAAc,GAAC3H,MAAM,CAACsH,CAAC,CAACK,cAAc,CAAC,GAAC,EAAE;MAAEoB,QAAQ,EAACzB,CAAC,CAACM,eAAe,GAAC5H,MAAM,CAACsH,CAAC,CAACM,eAAe,CAAC,GAAC,EAAE;MAAEoB,KAAK,EAAC1B,CAAC,CAACO,YAAY,GAAC7H,MAAM,CAACsH,CAAC,CAACO,YAAY,CAAC,GAAC;IAAE,CAAC,CAAC,CAAC;IACvU,MAAMoB,EAAE,GAACtJ,IAAI,CAACuJ,KAAK,CAACC,aAAa,CAAC5D,IAAI,CAAC;IAAE,MAAM6D,EAAE,GAACzJ,IAAI,CAACuJ,KAAK,CAACG,QAAQ,CAAC,CAAC;IAAE1J,IAAI,CAACuJ,KAAK,CAACI,iBAAiB,CAACF,EAAE,EAACH,EAAE,EAAC,QAAQ,CAAC;IAAEtJ,IAAI,CAAC4J,SAAS,CAACH,EAAE,EAAC,cAAczG,KAAK,CAACE,IAAI,IAAIF,KAAK,CAACG,EAAE,OAAO,CAAC;IAAEwB,SAAS,CAAC,SAAS,EAAC,mBAAmB,CAAC;EACjO;EACA,SAASkF,SAASA,CAAA,EAAE;IAClB,MAAMC,GAAG,GAAC,IAAI/J,KAAK,CAAC;MAACgK,WAAW,EAAC,GAAG;MAACC,IAAI,EAAC,IAAI;MAACC,MAAM,EAAC;IAAI,CAAC,CAAC;IAAEH,GAAG,CAACI,WAAW,CAAC,EAAE,CAAC;IAAEJ,GAAG,CAACK,IAAI,CAAC,qBAAqBnH,KAAK,CAACE,IAAI,MAAMF,KAAK,CAACG,EAAE,EAAE,EAAC,EAAE,EAAC,EAAE,CAAC;IAClJ,MAAMiH,KAAK,GAAChH,IAAI,CAACsE,GAAG,CAACC,CAAC,IAAE,CAACA,CAAC,CAACI,IAAI,EAAEJ,CAAC,CAAC3D,OAAO,GAAC,IAAInD,IAAI,CAAC8G,CAAC,CAAC3D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAC,GAAG,EAAEwC,CAAC,CAAC1D,QAAQ,GAAC,IAAIpD,IAAI,CAAC8G,CAAC,CAAC1D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAC,GAAG,EAAEwC,CAAC,CAACK,cAAc,GAAC3H,MAAM,CAACsH,CAAC,CAACK,cAAc,CAAC,GAAC,GAAG,EAAEL,CAAC,CAACM,eAAe,GAAC5H,MAAM,CAACsH,CAAC,CAACM,eAAe,CAAC,GAAC,GAAG,EAAEN,CAAC,CAACO,YAAY,GAAC7H,MAAM,CAACsH,CAAC,CAACO,YAAY,CAAC,GAAC,GAAG,CAAC,CAAC;IAC9R4B,GAAG,CAACO,SAAS,CAAC;MAAEC,IAAI,EAAC,CAAC,CAAC,MAAM,EAAC,UAAU,EAAC,WAAW,EAAC,SAAS,EAAC,UAAU,EAAC,OAAO,CAAC,CAAC;MAAEnE,IAAI,EAACiE,KAAK;MAAEG,MAAM,EAAC;IAAG,CAAC,CAAC;IAC7G,MAAMC,CAAC,GAACV,GAAG,CAACW,aAAa,CAACC,MAAM,GAAC,EAAE;IAAEZ,GAAG,CAACI,WAAW,CAAC,EAAE,CAAC;IAAEJ,GAAG,CAACK,IAAI,CAAC,cAAc,EAAC,EAAE,EAACK,CAAC,CAAC;IAAEV,GAAG,CAACa,IAAI,CAAC,GAAG,EAACH,CAAC,GAAC,CAAC,EAAC,GAAG,EAACA,CAAC,GAAC,CAAC,CAAC;IAAEV,GAAG,CAACK,IAAI,CAAC,aAAa,EAAC,GAAG,EAACK,CAAC,GAAC,EAAE,CAAC;IAAEV,GAAG,CAACK,IAAI,CAAC,cAAc,IAAItJ,IAAI,CAAC,CAAC,CAAC+J,cAAc,CAAC,CAAC,EAAE,EAAC,EAAE,EAACJ,CAAC,GAAC,EAAE,CAAC;IACnNV,GAAG,CAACe,IAAI,CAAC,cAAc7H,KAAK,CAACE,IAAI,IAAIF,KAAK,CAACG,EAAE,MAAM,CAAC;IAAEwB,SAAS,CAAC,SAAS,EAAC,UAAU,CAAC;EACvF;;EAEA;EACA,SAASmG,QAAQA,CAACnD,CAAC,EAAC;IAAA,IAAAoD,eAAA;IAClB,IAAI,EAACrI,EAAE,aAAFA,EAAE,gBAAAqI,eAAA,GAAFrI,EAAE,CAAE2C,WAAW,cAAA0F,eAAA,eAAfA,eAAA,CAAiBC,cAAc,GAAE;IACtCnH,eAAe,CAAC8D,CAAC,CAAC;IAClB5D,WAAW,CAAC;MACVC,OAAO,EAAE2D,CAAC,CAAC3D,OAAO,GAAG,IAAInD,IAAI,CAAC8G,CAAC,CAAC3D,OAAO,CAAC,CAAC9C,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC,GAAG,EAAE;MACvE8C,QAAQ,EAAE0D,CAAC,CAAC1D,QAAQ,GAAG,IAAIpD,IAAI,CAAC8G,CAAC,CAAC1D,QAAQ,CAAC,CAAC/C,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,EAAC,EAAE,CAAC,GAAG,EAAE;MAC1E+C,KAAK,EAAEyD,CAAC,CAACzD,KAAK,IAAI;IACpB,CAAC,CAAC;IACFP,WAAW,CAAC,IAAI,CAAC;EACnB;EACA,eAAesH,QAAQA,CAAA,EAAE;IACvB,IAAG;MACD,MAAM9E,IAAI,GAAC,CAAC,CAAC;MACb,IAAIrC,QAAQ,CAACE,OAAO,EAAEmC,IAAI,CAACnC,OAAO,GAAG,IAAInD,IAAI,CAACiD,QAAQ,CAACE,OAAO,CAAC,CAAC9C,WAAW,CAAC,CAAC;MAC7E,IAAI4C,QAAQ,CAACG,QAAQ,EAAEkC,IAAI,CAAClC,QAAQ,GAAG,IAAIpD,IAAI,CAACiD,QAAQ,CAACG,QAAQ,CAAC,CAAC/C,WAAW,CAAC,CAAC;MAChFiF,IAAI,CAACjC,KAAK,GAAGJ,QAAQ,CAACI,KAAK,IAAI,EAAE;MACjC,MAAMtE,GAAG,CAAC,mBAAmBgE,YAAY,CAACsH,GAAG,EAAE,EAAE;QAAEhF,MAAM,EAAC,KAAK;QAAEC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACF,IAAI;MAAE,CAAC,CAAC;MAC9FxC,WAAW,CAAC,KAAK,CAAC;MAClB,MAAM8B,YAAY,CAACzC,KAAK,CAACE,IAAI,EAAEF,KAAK,CAACG,EAAE,EAAEK,YAAY,CAAC;MACtD,MAAMgC,YAAY,CAAC,CAAC;MACpBb,SAAS,CAAC,SAAS,EAAC,cAAc,CAAC;IACrC,CAAC,QAAMgB,CAAC,EAAC;MAAEhB,SAAS,CAAC,OAAO,EAAEgB,CAAC,CAACjB,OAAO,CAAC;IAAE;EAC5C;EAEA,MAAMyG,OAAO,GAAC,CAAC,EAACvI,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEoB,OAAO,KAAI,EAACpB,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEqB,QAAQ;EAClD,MAAMmH,YAAY,GAAC,CAAC,CAAC,CAAC,CAAAxI,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEyI,MAAM,KAAE,EAAE,EAAEC,IAAI,CAACC,CAAC,IAAEA,CAAC,CAACC,KAAK,IAAI,CAACD,CAAC,CAACE,GAAG,CAAC;EACnE,MAAMC,OAAO,GAAG,CAAAhJ,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEiJ,IAAI,MAAK,OAAO,KAAIjJ,EAAE,aAAFA,EAAE,wBAAAL,gBAAA,GAAFK,EAAE,CAAE2C,WAAW,cAAAhD,gBAAA,uBAAfA,gBAAA,CAAiBuJ,WAAW;EAEpE,oBACE1L,OAAA;IAAK2L,SAAS,EAAC,kBAAkB;IAAAC,QAAA,gBAC/B5L,OAAA,CAACL,KAAK;MAAC0E,IAAI,EAAEF,KAAK,CAACE,IAAK;MAACC,IAAI,EAAEH,KAAK,CAACG,IAAK;MAACC,KAAK,EAAEJ,KAAK,CAACI,KAAM;MAACC,OAAO,EAAEL,KAAK,CAACK,OAAQ;MAACqH,OAAO,EAAEnH;IAAW;MAAAoH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eAG9GjM,OAAA,CAACJ,KAAK;MACJsM,IAAI,EAAE1I,QAAS;MACfe,KAAK,EAAC,+DAAa;MACnBsH,OAAO,EAAEA,CAAA,KAAIpI,WAAW,CAAC,KAAK,CAAE;MAChC0I,OAAO,eACLnM,OAAA,CAAAE,SAAA;QAAA0L,QAAA,gBACE5L,OAAA;UAAQ2L,SAAS,EAAC,sCAAsC;UAACS,OAAO,EAAEA,CAAA,KAAI3I,WAAW,CAAC,KAAK,CAAE;UAAAmI,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eACxGjM,OAAA;UAAQ2L,SAAS,EAAC,0CAA0C;UAACS,OAAO,EAAErB,QAAS;UAAAa,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA,eAC9F,CACH;MAAAL,QAAA,gBAED5L,OAAA;QAAA4L,QAAA,gBACE5L,OAAA;UAAO2L,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAQ;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACtDjM,OAAA;UAAOsE,IAAI,EAAC,gBAAgB;UAACqH,SAAS,EAAC,oCAAoC;UACpEU,KAAK,EAAEzI,QAAQ,CAACE,OAAQ;UAACwI,QAAQ,EAAE7G,CAAC,IAAE5B,WAAW,CAAC0I,CAAC,KAAG;YAAC,GAAGA,CAAC;YAACzI,OAAO,EAAC2B,CAAC,CAAC+G,MAAM,CAACH;UAAK,CAAC,CAAC;QAAE;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5F,CAAC,eACNjM,OAAA;QAAA4L,QAAA,gBACE5L,OAAA;UAAO2L,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAS;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACvDjM,OAAA;UAAOsE,IAAI,EAAC,gBAAgB;UAACqH,SAAS,EAAC,oCAAoC;UACpEU,KAAK,EAAEzI,QAAQ,CAACG,QAAS;UAACuI,QAAQ,EAAE7G,CAAC,IAAE5B,WAAW,CAAC0I,CAAC,KAAG;YAAC,GAAGA,CAAC;YAACxI,QAAQ,EAAC0B,CAAC,CAAC+G,MAAM,CAACH;UAAK,CAAC,CAAC;QAAE;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9F,CAAC,eACNjM,OAAA;QAAA4L,QAAA,gBACE5L,OAAA;UAAO2L,SAAS,EAAC,oBAAoB;UAAAC,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC,eACnDjM,OAAA;UAAU2L,SAAS,EAAC,oCAAoC;UAACzI,IAAI,EAAE,CAAE;UACvDmJ,KAAK,EAAEzI,QAAQ,CAACI,KAAM;UAACsI,QAAQ,EAAE7G,CAAC,IAAE5B,WAAW,CAAC0I,CAAC,KAAG;YAAC,GAAGA,CAAC;YAACvI,KAAK,EAACyB,CAAC,CAAC+G,MAAM,CAACH;UAAK,CAAC,CAAC;QAAE;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC3F,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACD,CAAC,eAERjM,OAAA;MAAQ2L,SAAS,EAAC,wCAAwC;MAAAC,QAAA,gBACxD5L,OAAA;QAAK2L,SAAS,EAAC,yBAAyB;QAAAC,QAAA,gBACtC5L,OAAA;UAAKyM,GAAG,EAAC,WAAW;UAACC,GAAG,EAAC,SAAS;UAACf,SAAS,EAAC;QAAsB;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAE,CAAC,eACtEjM,OAAA;UAAA4L,QAAA,gBACE5L,OAAA;YAAK2L,SAAS,EAAC,uBAAuB;YAAAC,QAAA,GAAC,2BAAK,EAAC,CAAApJ,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEmK,IAAI,KAAI,EAAE;UAAA;YAAAb,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAClEjM,OAAA;YAAK2L,SAAS,EAAC,wBAAwB;YAAAC,QAAA,EAAEpJ,EAAE,aAAFA,EAAE,uBAAFA,EAAE,CAAEoK;UAAK;YAAAd,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtD,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAENjM,OAAA;QAAK2L,SAAS,EAAC,yBAAyB;QAAAC,QAAA,GACrCJ,OAAO,iBACNxL,OAAA;UAAGkH,IAAI,EAAC,cAAc;UAACyE,SAAS,EAAC,qDAAqD;UAAAC,QAAA,EAAC;QAAa;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CACxG,eACDjM,OAAA;UAAK2L,SAAS,EAAE,2CAA2CT,YAAY,GAAG,cAAc,GAAGD,OAAO,GAAG,gBAAgB,GAAG,cAAc,EAAG;UAAAW,QAAA,EACtIV,YAAY,GAAG,QAAQ,GAAGD,OAAO,GAAG,QAAQ,GAAG;QAAW;UAAAa,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxD,CAAC,eACNjM,OAAA;UAAK2L,SAAS,EAAC,8CAA8C;UAAAC,QAAA,EAAE5G;QAAQ;UAAA8G,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAC9EjM,OAAA;UAAQoM,OAAO,EAAEvF,MAAO;UAAC8E,SAAS,EAAC,wDAAwD;UAAAC,QAAA,EAAC;QAAK;UAAAE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvG,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACA,CAAC,EAERrJ,GAAG,iBAAI5C,OAAA;MAAK2L,SAAS,EAAC,oBAAoB;MAAAC,QAAA,EAAEhJ;IAAG;MAAAkJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,eAEvDjM,OAAA;MAAM2L,SAAS,EAAC,2BAA2B;MAAAC,QAAA,gBAEzC5L,OAAA;QAAK2L,SAAS,EAAC,iCAAiC;QAAAC,QAAA,gBAC9C5L,OAAA;UAAK2L,SAAS,EAAC,wCAAwC;UAAAC,QAAA,gBACrD5L,OAAA;YAAI2L,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAe;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,EACzD,EAAA7J,qBAAA,GAACI,EAAE,aAAFA,EAAE,wBAAAH,gBAAA,GAAFG,EAAE,CAAE2C,WAAW,cAAA9C,gBAAA,uBAAfA,gBAAA,CAAiBwK,aAAa,cAAAzK,qBAAA,cAAAA,qBAAA,GAAI,IAAI,kBACtCpC,OAAA;YAAK2L,SAAS,EAAC,oBAAoB;YAAAC,QAAA,gBACjC5L,OAAA;cAAQoM,OAAO,EAAEjF,SAAU;cAACwE,SAAS,EAAC,WAAW;cAAAC,QAAA,EAAC;YAAG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eAC9DjM,OAAA;cAAQoM,OAAO,EAAEtD,UAAW;cAAC6C,SAAS,EAAC,WAAW;cAAAC,QAAA,EAAC;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACjEjM,OAAA;cAAQoM,OAAO,EAAEzC,SAAU;cAACgC,SAAS,EAAC,WAAW;cAAAC,QAAA,EAAC;YAAG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3D,CACN;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACE,CAAC,eAENjM,OAAA;UAAM8M,QAAQ,EAAE1G,UAAW;UAACuF,SAAS,EAAC,qCAAqC;UAAAC,QAAA,gBACzE5L,OAAA;YAAA4L,QAAA,gBACE5L,OAAA;cAAO2L,SAAS,EAAC,oBAAoB;cAAAC,QAAA,EAAC;YAAM;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACpDjM,OAAA;cAAOsE,IAAI,EAAC,MAAM;cAACqH,SAAS,EAAC,6BAA6B;cAACU,KAAK,EAAEvJ,KAAK,CAACE,IAAK;cAACsJ,QAAQ,EAAG7G,CAAC,IAAG1C,QAAQ,CAACgK,CAAC,KAAG;gBAAC,GAAGA,CAAC;gBAAE/J,IAAI,EAACyC,CAAC,CAAC+G,MAAM,CAACH;cAAK,CAAC,CAAC,CAAE;cAACW,QAAQ;YAAA;cAAAlB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACjJ,CAAC,eACNjM,OAAA;YAAA4L,QAAA,gBACE5L,OAAA;cAAO2L,SAAS,EAAC,oBAAoB;cAAAC,QAAA,EAAC;YAAQ;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACtDjM,OAAA;cAAOsE,IAAI,EAAC,MAAM;cAACqH,SAAS,EAAC,6BAA6B;cAACU,KAAK,EAAEvJ,KAAK,CAACG,EAAG;cAACqJ,QAAQ,EAAG7G,CAAC,IAAG1C,QAAQ,CAACgK,CAAC,KAAG;gBAAC,GAAGA,CAAC;gBAAE9J,EAAE,EAACwC,CAAC,CAAC+G,MAAM,CAACH;cAAK,CAAC,CAAC,CAAE;cAACW,QAAQ;YAAA;cAAAlB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7I,CAAC,EAEL,CAAAzJ,EAAE,aAAFA,EAAE,wBAAAF,gBAAA,GAAFE,EAAE,CAAE2C,WAAW,cAAA7C,gBAAA,uBAAfA,gBAAA,CAAiB8C,iBAAiB,kBACjCpF,OAAA;YAAA4L,QAAA,gBACE5L,OAAA;cAAO2L,SAAS,EAAC,oBAAoB;cAAAC,QAAA,EAAC;YAAI;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAClDjM,OAAA;cAAQ2L,SAAS,EAAC,2CAA2C;cACrDU,KAAK,EAAE/I,YAAa;cAACgJ,QAAQ,EAAG7G,CAAC,IAAGlC,eAAe,CAACkC,CAAC,CAAC+G,MAAM,CAACH,KAAK,CAAE;cAAAT,QAAA,gBAC1E5L,OAAA;gBAAQqM,KAAK,EAAC,EAAE;gBAAAT,QAAA,EAAC;cAAkB;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,EAC3C7I,KAAK,CAACoE,GAAG,CAACyF,CAAC,iBACVjN,OAAA;gBAA4BqM,KAAK,EAAEY,CAAC,CAACjC,GAAG,IAAIiC,CAAC,CAACC,EAAG;gBAAAtB,QAAA,GAC9CqB,CAAC,CAACN,IAAI,EAAC,QAAG,EAACM,CAAC,CAACE,UAAU,IAAI,WAAW;cAAA,GAD5BF,CAAC,CAACjC,GAAG,IAAIiC,CAAC,CAACC,EAAE;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAElB,CACT,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CACN,eAEDjM,OAAA;YAAQ2L,SAAS,EAAC,KAAK;YAACrH,IAAI,EAAC,QAAQ;YAAC8I,QAAQ,EAAEnJ,IAAK;YAAA2H,QAAA,EAAC;UAAG;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9D,CAAC,eAEPjM,OAAA;UAAK2L,SAAS,EAAC,eAAe;UAAAC,QAAA,eAC5B5L,OAAA;YAAO2L,SAAS,EAAC,oBAAoB;YAAAC,QAAA,gBACnC5L,OAAA;cAAA4L,QAAA,eACE5L,OAAA;gBAAI2L,SAAS,EAAC,oBAAoB;gBAAAC,QAAA,gBAChC5L,OAAA;kBAAI2L,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAK;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC/BjM,OAAA;kBAAI2L,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAQ;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAClCjM,OAAA;kBAAI2L,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAS;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eACnCjM,OAAA;kBAAI2L,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAI;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAC9BjM,OAAA;kBAAI2L,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAM;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,eAChCjM,OAAA;kBAAI2L,SAAS,EAAC,MAAM;kBAAAC,QAAA,EAAC;gBAAI;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI,CAAC,EAC7B,CAAAzJ,EAAE,aAAFA,EAAE,wBAAAD,gBAAA,GAAFC,EAAE,CAAE2C,WAAW,cAAA5C,gBAAA,uBAAfA,gBAAA,CAAiBuI,cAAc,kBAAI9K,OAAA;kBAAI2L,SAAS,EAAC;gBAAM;kBAAAG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAK,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAC5D;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACRjM,OAAA;cAAA4L,QAAA,GACG1I,IAAI,CAACsE,GAAG,CAACC,CAAC;gBAAA,IAAA4F,gBAAA;gBAAA,oBACTrN,OAAA;kBAAgB2L,SAAS,EAAC,UAAU;kBAAAC,QAAA,gBAClC5L,OAAA;oBAAI2L,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEnE,CAAC,CAACI;kBAAI;oBAAAiE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAClCjM,OAAA;oBAAI2L,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEnE,CAAC,CAAC3D,OAAO,GAAG,IAAInD,IAAI,CAAC8G,CAAC,CAAC3D,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAG;kBAAG;oBAAA6G,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eACtFjM,OAAA;oBAAI2L,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEnE,CAAC,CAAC1D,QAAQ,GAAG,IAAIpD,IAAI,CAAC8G,CAAC,CAAC1D,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAG;kBAAG;oBAAA6G,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eACxFjM,OAAA;oBAAI2L,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEnE,CAAC,CAACK,cAAc,GAAG3H,MAAM,CAACsH,CAAC,CAACK,cAAc,CAAC,GAAG;kBAAG;oBAAAgE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAC7EjM,OAAA;oBAAI2L,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEnE,CAAC,CAACM,eAAe,GAAG5H,MAAM,CAACsH,CAAC,CAACM,eAAe,CAAC,GAAG;kBAAG;oBAAA+D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,eAC/EjM,OAAA;oBAAI2L,SAAS,EAAC,MAAM;oBAAAC,QAAA,EAAEnE,CAAC,CAACO,YAAY,GAAG7H,MAAM,CAACsH,CAAC,CAACO,YAAY,CAAC,GAAG;kBAAG;oBAAA8D,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK,CAAC,EACxE,CAAAzJ,EAAE,aAAFA,EAAE,wBAAA6K,gBAAA,GAAF7K,EAAE,CAAE2C,WAAW,cAAAkI,gBAAA,uBAAfA,gBAAA,CAAiBvC,cAAc,kBAC9B9K,OAAA;oBAAI2L,SAAS,EAAC,MAAM;oBAAAC,QAAA,eAClB5L,OAAA;sBAAQ2L,SAAS,EAAC,6BAA6B;sBAACS,OAAO,EAAEA,CAAA,KAAIxB,QAAQ,CAACnD,CAAC,CAAE;sBAAAmE,QAAA,EAAC;oBAAI;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ;kBAAC;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACrF,CACL;gBAAA,GAXMxE,CAAC,CAACuD,GAAG;kBAAAc,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAYV,CAAC;cAAA,CACN,CAAC,EACD,CAAC/I,IAAI,CAACoK,MAAM,iBAAItN,OAAA;gBAAA4L,QAAA,eAAI5L,OAAA;kBAAI2L,SAAS,EAAC,qBAAqB;kBAAC4B,OAAO,EAAE,CAAE;kBAAA3B,QAAA,EAAC;gBAAoB;kBAAAE,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAI;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC9F,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACL,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAGNjM,OAAA;QAAK2L,SAAS,EAAC,iCAAiC;QAAAC,QAAA,gBAC9C5L,OAAA;UAAK2L,SAAS,EAAC,wCAAwC;UAAAC,QAAA,gBACrD5L,OAAA;YAAI2L,SAAS,EAAC,uBAAuB;YAAAC,QAAA,EAAC;UAAI;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eAC/CjM,OAAA;YAAK2L,SAAS,EAAC,wBAAwB;YAAAC,QAAA,EAAEX,OAAO,GAAG,cAAc,GAAG;UAAW;YAAAa,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnF,CAAC,eAENjM,OAAA;UAAK2L,SAAS,EAAC,2BAA2B;UAAAC,QAAA,gBACxC5L,OAAA;YAAQ2L,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAEnJ,IAAI,IAAIgH,OAAQ;YAACmB,OAAO,EAAEA,CAAA,KAAIzG,MAAM,CAAC,yBAAyB,EAAC,gBAAgB,CAAE;YAAAiG,QAAA,EAAC;UAAQ;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACrIjM,OAAA;YAAQ2L,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAEnJ,IAAI,IAAI,CAACgH,OAAQ;YAACmB,OAAO,EAAEA,CAAA,KAAIzG,MAAM,CAAC,0BAA0B,EAAC,iBAAiB,CAAE;YAAAiG,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eACzIjM,OAAA;YAAQ2L,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAEnJ,IAAI,IAAI,CAACgH,OAAO,IAAIC,YAAa;YAACkB,OAAO,EAAEA,CAAA,KAAIzG,MAAM,CAAC,6BAA6B,EAAC,cAAc,CAAE;YAAAiG,QAAA,EAAC;UAAW;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC,eAC3JjM,OAAA;YAAQ2L,SAAS,EAAC,KAAK;YAACyB,QAAQ,EAAEnJ,IAAI,IAAI,CAACgH,OAAO,IAAI,CAACC,YAAa;YAACkB,OAAO,EAAEA,CAAA,KAAIzG,MAAM,CAAC,2BAA2B,EAAC,eAAe,CAAE;YAAAiG,QAAA,EAAC;UAAS;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtJ,CAAC,eAENjM,OAAA;UAAK2L,SAAS,EAAC,WAAW;UAAAC,QAAA,gBACxB5L,OAAA;YAAA4L,QAAA,gBAAK5L,OAAA;cAAA4L,QAAA,EAAG;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACvJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEoB,OAAO,GAAG,IAAInD,IAAI,CAAC+B,KAAK,CAACoB,OAAO,CAAC,CAACmB,kBAAkB,CAAC,CAAC,GAAG,GAAG;UAAA;YAAA6G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACjGjM,OAAA;YAAA4L,QAAA,gBAAK5L,OAAA;cAAA4L,QAAA,EAAG;YAAU;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACvJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEqB,QAAQ,GAAG,IAAIpD,IAAI,CAAC+B,KAAK,CAACqB,QAAQ,CAAC,CAACkB,kBAAkB,CAAC,CAAC,GAAG,GAAG;UAAA;YAAA6G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACpGjM,OAAA;YAAA4L,QAAA,gBAAK5L,OAAA;cAAA4L,QAAA,EAAG;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACvJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEsF,YAAY,GAAG7H,MAAM,CAACuC,KAAK,CAACsF,YAAY,CAAC,GAAG,GAAG;UAAA;YAAA8D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAChFjM,OAAA;YAAA4L,QAAA,gBAAK5L,OAAA;cAAA4L,QAAA,EAAG;YAAK;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACvJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEoF,cAAc,GAAG3H,MAAM,CAACuC,KAAK,CAACoF,cAAc,CAAC,GAAG,GAAG;UAAA;YAAAgE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACpFjM,OAAA;YAAA4L,QAAA,gBAAK5L,OAAA;cAAA4L,QAAA,EAAG;YAAO;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,KAAC,EAACvJ,KAAK,aAALA,KAAK,eAALA,KAAK,CAAEqF,eAAe,GAAG5H,MAAM,CAACuC,KAAK,CAACqF,eAAe,CAAC,GAAG,GAAG;UAAA;YAAA+D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACxFjM,OAAA;YAAA4L,QAAA,gBACE5L,OAAA;cAAA4L,QAAA,EAAG;YAAO;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAG,CAAC,eACdjM,OAAA;cAAI2L,SAAS,EAAC,gBAAgB;cAAAC,QAAA,EAC3B,CAAC,CAAAlJ,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEyI,MAAM,KAAI,EAAE,EAAE3D,GAAG,CAAC,CAAC6D,CAAC,EAACmC,CAAC,kBAC7BxN,OAAA;gBAAA4L,QAAA,GAAaP,CAAC,CAACC,KAAK,GAAC,IAAI3K,IAAI,CAAC0K,CAAC,CAACC,KAAK,CAAC,CAACrG,kBAAkB,CAAC,CAAC,GAAC,GAAG,EAAC,UAAG,EAACoG,CAAC,CAACE,GAAG,GAAC,IAAI5K,IAAI,CAAC0K,CAAC,CAACE,GAAG,CAAC,CAACtG,kBAAkB,CAAC,CAAC,GAAC,GAAG;cAAA,GAAzGuI,CAAC;gBAAA1B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAA6G,CACxH;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACF,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,eAEPjM,OAAA;MAAA4L,QAAA,EAAQ;IAA2H;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACzI,CAAC;AAEV;AAAC/J,EAAA,CApSuBD,SAAS;AAAAwL,EAAA,GAATxL,SAAS;AAAA,IAAAwL,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}