{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Desktop\\\\timewatch-clone\\\\client\\\\src\\\\context\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// client/src/context/AuthContext.js\nimport React, { createContext, useContext, useEffect, useMemo, useState } from 'react';\nimport { api } from '../api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthCtx = /*#__PURE__*/createContext(null);\nexport function AuthProvider({\n  children\n}) {\n  _s();\n  const [auth, setAuth] = useState(() => {\n    const stored = localStorage.getItem('auth');\n    return stored ? JSON.parse(stored) : {\n      token: null,\n      user: null\n    };\n  });\n  const [loading, setLoading] = useState(false);\n\n  // שמירת סטייט בלוקאל־סטורז'\n  useEffect(() => {\n    localStorage.setItem('auth', JSON.stringify(auth));\n    if (auth !== null && auth !== void 0 && auth.token) {\n      api.defaults.headers.common.Authorization = `Bearer ${auth.token}`;\n    } else {\n      delete api.defaults.headers.common.Authorization;\n    }\n  }, [auth]);\n\n  // טעינת /me אם יש טוקן\n  useEffect(() => {\n    const bootstrap = async () => {\n      if (!(auth !== null && auth !== void 0 && auth.token)) return;\n      try {\n        setLoading(true);\n        const {\n          data\n        } = await api.get('/auth/me');\n        setAuth(prev => ({\n          ...prev,\n          user: data\n        }));\n      } catch {\n        setAuth({\n          token: null,\n          user: null\n        });\n      } finally {\n        setLoading(false);\n      }\n    };\n    bootstrap();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const login = async (email, password) => {\n    const {\n      data\n    } = await api.post('/auth/login', {\n      email,\n      password\n    });\n    setAuth({\n      token: data.token,\n      user: data.user\n    });\n    return data.user;\n  };\n  const logout = () => {\n    setAuth({\n      token: null,\n      user: null\n    });\n  };\n  const value = useMemo(() => ({\n    auth,\n    setAuth,\n    login,\n    logout,\n    loading\n  }), [auth, loading]);\n  return /*#__PURE__*/_jsxDEV(AuthCtx.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 10\n  }, this);\n}\n_s(AuthProvider, \"UWZtVuB5MZy/ovHkStzjejeKYck=\");\n_c = AuthProvider;\nexport function useAuth() {\n  _s2();\n  return useContext(AuthCtx);\n}\n_s2(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useMemo","useState","api","jsxDEV","_jsxDEV","AuthCtx","AuthProvider","children","_s","auth","setAuth","stored","localStorage","getItem","JSON","parse","token","user","loading","setLoading","setItem","stringify","defaults","headers","common","Authorization","bootstrap","data","get","prev","login","email","password","post","logout","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","$RefreshReg$"],"sources":["C:/Users/user/Desktop/timewatch-clone/client/src/context/AuthContext.js"],"sourcesContent":["// client/src/context/AuthContext.js\r\nimport React, { createContext, useContext, useEffect, useMemo, useState } from 'react';\r\nimport { api } from '../api';\r\n\r\nconst AuthCtx = createContext(null);\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [auth, setAuth] = useState(() => {\r\n    const stored = localStorage.getItem('auth');\r\n    return stored ? JSON.parse(stored) : { token: null, user: null };\r\n  });\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // שמירת סטייט בלוקאל־סטורז'\r\n  useEffect(() => {\r\n    localStorage.setItem('auth', JSON.stringify(auth));\r\n    if (auth?.token) {\r\n      api.defaults.headers.common.Authorization = `Bearer ${auth.token}`;\r\n    } else {\r\n      delete api.defaults.headers.common.Authorization;\r\n    }\r\n  }, [auth]);\r\n\r\n  // טעינת /me אם יש טוקן\r\n  useEffect(() => {\r\n    const bootstrap = async () => {\r\n      if (!auth?.token) return;\r\n      try {\r\n        setLoading(true);\r\n        const { data } = await api.get('/auth/me');\r\n        setAuth((prev) => ({ ...prev, user: data }));\r\n      } catch {\r\n        setAuth({ token: null, user: null });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    bootstrap();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const login = async (email, password) => {\r\n    const { data } = await api.post('/auth/login', { email, password });\r\n    setAuth({ token: data.token, user: data.user });\r\n    return data.user;\r\n  };\r\n\r\n  const logout = () => {\r\n    setAuth({ token: null, user: null });\r\n  };\r\n\r\n  const value = useMemo(() => ({ auth, setAuth, login, logout, loading }), [auth, loading]);\r\n\r\n  return <AuthCtx.Provider value={value}>{children}</AuthCtx.Provider>;\r\n}\r\n\r\nexport function useAuth() {\r\n  return useContext(AuthCtx);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}